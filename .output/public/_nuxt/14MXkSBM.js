const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./86auEJMD.js","./DjTJqZtn.js","./entry.DofVldok.css","./B_OshFF3.js","./O9dB02R4.js"])))=>i.map(i=>d[i]);
import{bJ as _t,aE as Tt,_ as cn,r as b,bK as dt,k as pe,a9 as Ue,aA as Qn,O as Vt,z as M,A as I,Q as se,E as n,B as f,P as ae,T as we,ay as Oe,G as H,R as Ie,ag as De,ah as qe,S as Je,bL as es,bM as ts,a7 as Be,bN as ns,a2 as Ce,h as ss,aO as is,bo as as,g as un,bO as ls,C as U,H as Fe,D as N,a3 as Jt,bb as dn,bP as os,bd as rs,be as cs,ao as fn,bQ as us,x as ft,au as pn,bR as Ze,bS as ds,aa as fs,y as mn,o as Mt,aH as ps,V as je,bT as It,N as ms,ab as hs,af as vs,an as hn,bU as vn,M as gn,bV as gs,av as ys,X as Zt,W as bs,bC as Ge,$ as xs,F as ge,aW as lt,bW as ws,bX as Ss,Z as Ve,bY as Qt,at as ks,bZ as _s,b_ as Ts,a0 as Is,ap as Cs,b$ as Ps,L as Le,q as en,c0 as zs,al as $s,c1 as Es}from"./DjTJqZtn.js";import{_ as Rs}from"./DciO7YSL.js";import{u as Vs,_ as Ms}from"./C3s5vo0a.js";import{E as As}from"./DH-e6x_Y.js";import{_ as Os}from"./DwHHYw6N.js";import{E as Ls,u as yn,P as We,C as Pt,T as Ds,a as ot,b as rt,D as tn}from"./CindA9jZ.js";/* empty css        */import{x as bn,P as nn,I as sn}from"./y8cjFsai.js";import"./CPyf-64M.js";const an={install(e){_t._context=e._context,Tt._context=e._context,e.directive("loading",Tt),e.config.globalProperties.$loading=_t},directive:Tt,service:_t},Fs={class:"custom-controls flex h-full w-full items-center rounded-lg bg-white py-2 text-black"},Ns={class:"play-control relative me-2 ms-1 cursor-pointer"},Bs={key:0,class:"flex h-6 w-6 items-center justify-center"},js={key:1,class:"flex h-6 w-6 items-center justify-center"},Us={class:"play-pause-tooltip pointer-events-none absolute -top-7 left-1/2 z-20 -translate-x-1/2 transform rounded px-0 py-0 text-xs opacity-0"},Ws={class:"me-2 ms-2 whitespace-nowrap text-sm text-gray-500"},Hs={class:"me-2 ms-2 whitespace-nowrap text-sm text-gray-500"},qs={key:0,class:"iconfont icon-shipinyinliangda text-black",style:{"font-size":"1.175rem"}},Xs={key:1,class:"iconfont icon-yinliang text-black",style:{"font-size":"1.275rem"}},Ks={key:2,class:"iconfont icon-shipinjingyin text-black",style:{"font-size":"1.275rem"}},Ys={class:"mb-2 text-center text-xs text-black"},Gs={class:"flex w-full items-center justify-center"},Js={class:"flex !h-12 !w-12 items-center"},Zs={class:"playback-rate-button flex !h-9 !w-10 items-center justify-center rounded-lg hover:bg-[rgba(0,0,0,0.15)] focus:outline-none"},Qs={class:"text-sm"},ei={class:"flex w-[4.25rem] flex-col"},ti=["onClick"],ni=16,si={__name:"VideoControls.client",props:{player:Object,onlyShowProgress:{type:Boolean,default:!1}},setup(e){const t=e,s=b(["3.0","2.0","1.5","1.25","1.0","0.75","0.5"]),l=b({.5:"0.5X",.75:"0.75X",1:"1.0X",1.25:"1.25X",1.5:"1.5X",2:"2.0X",3:"3.0X"}),o=dt("(min-width: 768px)"),p=b(!1),v=b(0),i=b(0),m=b(.6),z=b(.6),x=b(!1),L=b("1.0"),T=b(null),D=b(!1),q=b(!1),K=b(0),g=b(0),j=b(!1),J=b(null),$=b(!1),S=b(!1);let ie=null,le=null,oe=null,ee=null,ne=!1,F=null;const W=pe(()=>{const A=t.player.i18n,P=t.player.i18nKeys;return p.value?A[P.PAUSE_TIPS]:A[P.PLAY_TIPS]}),V=pe(()=>document.body.dir==="rtl"),O=pe(()=>i.value>0?v.value/i.value*100:0),Z=pe(()=>x.value?0:m.value*100),he=pe(()=>V.value?{width:O.value+"%",right:0,left:"auto"}:{width:O.value+"%"}),k=pe(()=>V.value?{right:O.value+"%",transform:"translate(50%, -50%)"}:{left:O.value+"%",transform:"translate(-50%, -50%)"}),X=pe(()=>{var P;const A=((P=T.value)==null?void 0:P.clientWidth)||0;return V.value?{right:A-g.value+"px",transform:"translateX(50%)"}:{left:g.value+"px",transform:"translateX(-50%)"}}),Q=A=>yn.format(A),G=(A,P)=>{let E=!1;return function(){E||(A.apply(this,arguments),E=!0,setTimeout(()=>{E=!1},P))}},B=()=>{t.player&&(p.value?t.player.pause():v.value>=i.value?t.player.replay():t.player.play(),p.value=!p.value)},re=A=>{if(!t.player||!T.value||D.value||A.target.classList.contains("progress-thumb"))return;A.stopPropagation(),A.preventDefault();const P=!t.player.paused,E=T.value.getBoundingClientRect();let te=A.clientX-E.left;V.value&&(te=E.width-te),te=Math.max(0,Math.min(te,E.width));const me=te/E.width,ce=Math.max(0,Math.min(me*i.value,i.value));t.player.seek?t.player.seek(ce,P?"play":"pause"):(t.player.currentTime=ce,P&&t.player.paused&&t.player.play()),v.value=ce},d=()=>{if(!ne||!F||!D.value||!T.value||!t.player){ee=null,ne=!1;return}const A=F,P=T.value.getBoundingClientRect();let E=A.clientX-P.left;V.value&&(E=P.width-E),E=Math.max(0,Math.min(E,P.width));const te=E/P.width,me=Math.max(0,Math.min(te*i.value,i.value));t.player.currentTime=me,v.value=me,ne=!1,ee=null},a=G(A=>{if(D.value&&t.player&&T.value){const P=T.value.getBoundingClientRect();let E=A.clientX;E<P.left?E=P.left:E>P.right&&(E=P.right),F=new MouseEvent("mousemove",{clientX:E,clientY:A.clientY}),ne||(ne=!0,ee=requestAnimationFrame(d)),A.preventDefault(),A.stopPropagation()}},ni),u=A=>{if(!t.player)return;S.value=!t.player.paused,D.value=!0,document.addEventListener("mousemove",a),document.addEventListener("mouseup",r,{once:!0});const P=A.currentTarget;P&&(P.classList.add("dragging"),document.body.style.cursor="grabbing");const E=T.value.getBoundingClientRect();let te=A.clientX-E.left;V.value&&(te=E.width-te);const me=Math.min(Math.max(te/E.width,0),1),ce=Math.max(0,Math.min(me*i.value,i.value));t.player.currentTime=ce,v.value=ce,A.preventDefault(),A.stopPropagation()},r=A=>{if(!D.value||!t.player)return;if(ee&&(cancelAnimationFrame(ee),ee=null),ne=!1,A&&T.value){const E=T.value.getBoundingClientRect();let te=A.clientX-E.left;V.value&&(te=E.width-te),te=Math.max(0,Math.min(te,E.width));const me=te/E.width,ce=Math.max(0,Math.min(me*i.value,i.value));t.player.seek?t.player.seek(ce,S.value?"play":"pause"):(t.player.currentTime=ce,S.value&&t.player.paused&&t.player.play()),v.value=ce}const P=document.querySelector(".progress-thumb");P&&P.classList.remove("dragging"),document.body.style.cursor="",D.value=!1,document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r)},y=()=>{t.player&&(x.value||m.value===0?(x.value=!1,m.value=z.value>0?z.value:.5):(z.value=m.value,x.value=!0),t.player.muted=x.value,t.player.volume=m.value,j.value=!0)},h=A=>{if(q.value&&T.value){const P=T.value.getBoundingClientRect();let E=A.clientX-P.left;if(E=Math.max(0,Math.min(E,P.width)),g.value=E,V.value){const te=P.width-E;K.value=Math.max(0,Math.min(te/P.width*i.value,i.value))}else K.value=Math.max(0,Math.min(E/P.width*i.value,i.value))}},w=A=>{if(!t.player||!J.value)return;const E=J.value.getBoundingClientRect(),te=E.bottom-A.clientY,me=E.height,ce=Math.min(Math.max(te/me,0),1);m.value=ce,t.player.volume=ce,x.value=ce<=0,t.player.muted=x.value},C=A=>{w(A),document.addEventListener("mousemove",R),document.addEventListener("mouseup",Y)},R=A=>{w(A)},Y=()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",Y)},be=A=>{ie&&clearTimeout(ie),ie=setTimeout(()=>{const P=document.querySelector(".volume-popup"),E=document.querySelector(".volume-control");if(P&&E&&A){const te=P.getBoundingClientRect(),me=E.getBoundingClientRect(),ce=A.clientX,ke=A.clientY;if(ce>=te.left&&ce<=te.right&&ke>=te.top&&ke<=te.bottom||ce>=me.left&&ce<=me.right&&ke>=me.top&&ke<=me.bottom)return}j.value=!1},300)},de=A=>{t.player&&(L.value=A,t.player.playbackRate=parseFloat(A),$.value=!1)},ve=A=>{le&&clearTimeout(le),le=setTimeout(()=>{const P=document.querySelector(".playback-rate-popup"),E=document.querySelector(".playback-rate");if(P&&E&&A){const te=P.getBoundingClientRect(),me=E.getBoundingClientRect(),ce=A.clientX,ke=A.clientY;if(ce>=te.left&&ce<=te.right&&ke>=te.top&&ke<=te.bottom||ce>=me.left&&ce<=me.right&&ke>=me.top&&ke<=me.bottom)return}$.value=!1},300)},Se=()=>{t.player&&(i.value=t.player.config.customDuration||t.player.duration||0,D.value||(v.value=t.player.currentTime||0),p.value=!t.player.paused,m.value=t.player.volume,x.value=t.player.muted||t.player.volume===0,t.player.muted&&(z.value=m.value),L.value=t.player.playbackRate.toString(),v.value>=i.value&&(v.value=i.value,t.player.pause(),t.player.emit(Ls)))};Ue(()=>t.player,(A,P)=>{A&&(Se(),oe&&clearInterval(oe),oe=Qn(Se,500))},{immediate:!0}),Vt(()=>{ie&&clearTimeout(ie),le&&clearTimeout(le),oe&&clearInterval(oe),ee&&cancelAnimationFrame(ee),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r),document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",Y)});const He=()=>{ie&&(clearTimeout(ie),ie=null)},mt=()=>{le&&(clearTimeout(le),le=null)};return(A,P)=>(I(),M("div",Fs,[e.onlyShowProgress?(I(),M("div",{key:0,class:se(["progress-container relative me-2 ms-2 flex-1 cursor-pointer rounded-full bg-[#E8E8F1]",{"dynamic-progress":n(o)}]),ref_key:"progressContainer",ref:T,onClick:re,onMouseenter:P[0]||(P[0]=E=>q.value=!0),onMouseleave:P[1]||(P[1]=E=>q.value=!1),onMousemove:h},[f("div",{class:"progress-bar rounded-full bg-[#3470FF]",style:we(he.value)},null,4),q.value&&n(o)||!n(o)?(I(),M("div",{key:0,class:se(["progress-thumb absolute top-1/2 cursor-pointer rounded-full",{"dynamic-thumb":n(o)}]),style:we(k.value),onMousedown:Oe(u,["stop"])},null,38)):ae("",!0),q.value&&n(o)?(I(),M("div",{key:1,class:"progress-tooltip absolute -top-10 rounded px-0 py-0 text-xs",style:we(X.value)},H(Q(K.value)),5)):ae("",!0)],34)):(I(),M(Ie,{key:1},[f("div",Ns,[f("button",{onClick:B,class:"play-pause-button flex !h-9 !w-9 items-center rounded-lg hover:bg-[rgba(0,0,0,0.15)] focus:outline-none"},[p.value?(I(),M("div",Bs,P[8]||(P[8]=[f("span",{class:"iconfont icon-zanting text-black",style:{"font-size":"1.375rem"}},null,-1)]))):(I(),M("div",js,P[9]||(P[9]=[f("span",{class:"iconfont icon-bofang text-black",style:{"font-size":"1.375rem"}},null,-1)])))]),f("div",Us,H(W.value),1)]),f("div",Ws,H(Q(v.value)),1),f("div",{class:se(["progress-container dynamic-progress relative me-2 ms-2 flex-1 cursor-pointer rounded-full bg-[#E8E8F1]"]),ref_key:"progressContainer",ref:T,onClick:re,onMouseenter:P[2]||(P[2]=E=>q.value=!0),onMouseleave:P[3]||(P[3]=E=>q.value=!1),onMousemove:h},[f("div",{class:"progress-bar rounded-full bg-[#3470FF]",style:we(he.value)},null,4),q.value&&n(o)?(I(),M("div",{key:0,class:se(["progress-thumb dynamic-thumb absolute top-1/2 cursor-pointer rounded-full"]),style:we(k.value),onMousedown:Oe(u,["stop"])},null,36)):ae("",!0),q.value?(I(),M("div",{key:1,class:"progress-tooltip absolute -top-10 rounded px-0 py-0 text-xs",style:we(X.value)},H(Q(K.value)),5)):ae("",!0)],544),f("div",Hs,H(Q(i.value)),1),f("div",{class:"volume-control relative me-5 ms-5 cursor-pointer",onMouseenter:P[5]||(P[5]=E=>j.value=!0),onMouseleave:be},[f("button",{onClick:y,class:"volume-button flex !h-9 !w-9 items-center rounded-lg hover:bg-[rgba(0,0,0,0.15)] focus:outline-none"},[!x.value&&m.value>.5?(I(),M("span",qs)):!x.value&&m.value>0?(I(),M("span",Xs)):(I(),M("span",Ks))]),De(f("div",{class:"volume-popup absolute bottom-11 left-1/2 z-10 -translate-x-1/2 transform rounded-lg bg-white p-3",onMouseenter:P[4]||(P[4]=E=>{j.value=!0,He()}),onMouseleave:be},[f("div",Ys,H(x.value?0:Math.round(m.value*100)),1),f("div",Gs,[f("div",{class:"vertical-volume-container relative flex h-24 w-1 cursor-pointer items-center justify-center rounded-full bg-gray-400",ref_key:"verticalVolumeContainer",ref:J,onMousedown:C,onClick:w},[f("div",{class:"vertical-volume-bar absolute bottom-0 w-full rounded-full bg-[#3470FF]",style:we({height:Z.value+"%"})},null,4),f("div",{class:"vertical-volume-thumb absolute h-3 w-3 rounded-full border-2 border-[#3470FF] bg-white",style:we({bottom:Z.value+"%",transform:"translateY(50%)"})},null,4)],544)])],544),[[qe,j.value]])],32),f("div",{class:"playback-rate relative me-5 cursor-pointer",onMouseenter:P[7]||(P[7]=E=>$.value=!0),onMouseleave:ve},[f("div",Js,[f("button",Zs,[f("span",Qs,H(l.value[L.value]),1)])]),De(f("div",{class:"playback-rate-popup absolute bottom-11 left-1/2 z-10 -translate-x-1/2 transform rounded-lg bg-white p-2",onMouseenter:P[6]||(P[6]=E=>{$.value=!0,mt()}),onMouseleave:ve},[f("div",ei,[(I(!0),M(Ie,null,Je(s.value,E=>(I(),M("button",{key:E,onClick:te=>de(E),class:se(["playback-rate-item",{"playback-rate-active":parseFloat(L.value)===parseFloat(E)}])},H(E)+"X ",11,ti))),128))])],544),[[qe,$.value]])],32)],64))]))}},xn=cn(si,[["__scopeId","data-v-49124b86"]]);function ii(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var s=e.indexOf("Trident/");if(s>0){var l=e.indexOf("rv:");return parseInt(e.substring(l+3,e.indexOf(".",l)),10)}var o=e.indexOf("Edge/");return o>0?parseInt(e.substring(o+5,e.indexOf(".",o)),10):-1}let ct;function zt(){zt.init||(zt.init=!0,ct=ii()!==-1)}var pt={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){zt(),Be(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",ct&&this.$el.appendChild(e),e.data="about:blank",ct||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!ct&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const ai=ns();es("data-v-b329ee4c");const li={class:"resize-observer",tabindex:"-1"};ts();const oi=ai((e,t,s,l,o,p)=>(I(),Ce("div",li)));pt.render=oi;pt.__scopeId="data-v-b329ee4c";pt.__file="src/components/ResizeObserver.vue";function ut(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ut=function(t){return typeof t}:ut=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(e)}function ri(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ci(e,t){for(var s=0;s<t.length;s++){var l=t[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function ui(e,t,s){return t&&ci(e.prototype,t),e}function ln(e){return di(e)||fi(e)||pi(e)||mi()}function di(e){if(Array.isArray(e))return $t(e)}function fi(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function pi(e,t){if(e){if(typeof e=="string")return $t(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return $t(e,t)}}function $t(e,t){(t==null||t>e.length)&&(t=e.length);for(var s=0,l=new Array(t);s<t;s++)l[s]=e[s];return l}function mi(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hi(e){var t;return typeof e=="function"?t={callback:e}:t=e,t}function vi(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l,o,p,v=function(m){for(var z=arguments.length,x=new Array(z>1?z-1:0),L=1;L<z;L++)x[L-1]=arguments[L];if(p=x,!(l&&m===o)){var T=s.leading;typeof T=="function"&&(T=T(m,o)),(!l||m!==o)&&T&&e.apply(void 0,[m].concat(ln(p))),o=m,clearTimeout(l),l=setTimeout(function(){e.apply(void 0,[m].concat(ln(p))),l=0},t)}};return v._clear=function(){clearTimeout(l),l=null},v}function wn(e,t){if(e===t)return!0;if(ut(e)==="object"){for(var s in e)if(!wn(e[s],t[s]))return!1;return!0}return!1}var gi=function(){function e(t,s,l){ri(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(s,l)}return ui(e,[{key:"createObserver",value:function(s,l){var o=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=hi(s),this.callback=function(i,m){o.options.callback(i,m),i&&o.options.once&&(o.frozen=!0,o.destroyObserver())},this.callback&&this.options.throttle){var p=this.options.throttleOptions||{},v=p.leading;this.callback=vi(this.callback,this.options.throttle,{leading:function(m){return v==="both"||v==="visible"&&m||v==="hidden"&&!m}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(i){var m=i[0];if(i.length>1){var z=i.find(function(L){return L.isIntersecting});z&&(m=z)}if(o.callback){var x=m.isIntersecting&&m.intersectionRatio>=o.threshold;if(x===o.oldResult)return;o.oldResult=x,o.callback(x,m)}},this.options.intersection),Be(function(){o.observer&&o.observer.observe(o.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function Sn(e,t,s){var l=t.value;if(l)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var o=new gi(e,l,s);e._vue_visibilityState=o}}function yi(e,t,s){var l=t.value,o=t.oldValue;if(!wn(l,o)){var p=e._vue_visibilityState;if(!l){kn(e);return}p?p.createObserver(l,s):Sn(e,{value:l},s)}}function kn(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var bi={beforeMount:Sn,updated:yi,unmounted:kn};function xi(e){return{all:e=e||new Map,on:function(t,s){var l=e.get(t);l&&l.push(s)||e.set(t,[s])},off:function(t,s){var l=e.get(t);l&&l.splice(l.indexOf(s)>>>0,1)},emit:function(t,s){(e.get(t)||[]).slice().map(function(l){l(s)}),(e.get("*")||[]).slice().map(function(l){l(t,s)})}}}var wi={itemsLimit:1e3},Si=/(auto|scroll)/;function _n(e,t){return e.parentNode===null?t:_n(e.parentNode,t.concat([e]))}var Ct=function(t,s){return getComputedStyle(t,null).getPropertyValue(s)},ki=function(t){return Ct(t,"overflow")+Ct(t,"overflow-y")+Ct(t,"overflow-x")},_i=function(t){return Si.test(ki(t))};function on(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var t=_n(e.parentNode,[]),s=0;s<t.length;s+=1)if(_i(t[s]))return t[s];return document.scrollingElement||document.documentElement}}function Et(e){"@babel/helpers - typeof";return Et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(e)}var Tn={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function In(){return this.items.length&&Et(this.items[0])!=="object"}var Rt=!1;if(typeof window<"u"){Rt=!1;try{var Ti=Object.defineProperty({},"passive",{get:function(){Rt=!0}});window.addEventListener("test",null,Ti)}catch{}}let Ii=0;var At={name:"RecycleScroller",components:{ResizeObserver:pt},directives:{ObserveVisibility:bi},props:{...Tn,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},t=this.items,s=this.sizeField,l=this.minItemSize;let o=1e4,p=0,v;for(let i=0,m=t.length;i<m;i++)v=t[i][s]||l,v<o&&(o=v),p+=v,e[i]={accumulator:p,size:v};return this.$_computedMinItemSize=o,e}return[]},simpleArray:In,itemIndexByKey(){const{keyField:e,items:t}=this,s={};for(let l=0,o=t.length;l<o;l++)s[t[l][e]]=l;return s}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,t,s,l,o){const p=is({id:Ii++,index:t,used:!0,key:l,type:o}),v=as({item:s,position:0,nr:p});return e.push(v),v},unuseView(e,t=!1){const s=this.$_unusedViews,l=e.nr.type;let o=s.get(l);o||(o=[],s.set(l,o)),o.push(e),t||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:s}=this.updateVisibleItems(!1,!0);s||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(e,t){this.ready&&(e||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,t=!1){const s=this.itemSize,l=this.gridItems||1,o=this.itemSecondarySize||s,p=this.$_computedMinItemSize,v=this.typeField,i=this.simpleArray?null:this.keyField,m=this.items,z=m.length,x=this.sizes,L=this.$_views,T=this.$_unusedViews,D=this.pool,q=this.itemIndexByKey;let K,g,j,J,$;if(!z)K=g=J=$=j=0;else if(this.$_prerender)K=J=0,g=$=Math.min(this.prerender,m.length),j=null;else{const F=this.getScroll();if(t){let O=F.start-this.$_lastUpdateScrollPosition;if(O<0&&(O=-O),s===null&&O<p||O<s)return{continuous:!0}}this.$_lastUpdateScrollPosition=F.start;const W=this.buffer;F.start-=W,F.end+=W;let V=0;if(this.$refs.before&&(V=this.$refs.before.scrollHeight,F.start-=V),this.$refs.after){const O=this.$refs.after.scrollHeight;F.end+=O}if(s===null){let O,Z=0,he=z-1,k=~~(z/2),X;do X=k,O=x[k].accumulator,O<F.start?Z=k:k<z-1&&x[k+1].accumulator>F.start&&(he=k),k=~~((Z+he)/2);while(k!==X);for(k<0&&(k=0),K=k,j=x[z-1].accumulator,g=k;g<z&&x[g].accumulator<F.end;g++);for(g===-1?g=m.length-1:(g++,g>z&&(g=z)),J=K;J<z&&V+x[J].accumulator<F.start;J++);for($=J;$<z&&V+x[$].accumulator<F.end;$++);}else{K=~~(F.start/s*l);const O=K%l;K-=O,g=Math.ceil(F.end/s*l),J=Math.max(0,Math.floor((F.start-V)/s*l)),$=Math.floor((F.end-V)/s*l),K<0&&(K=0),g>z&&(g=z),J<0&&(J=0),$>z&&($=z),j=Math.ceil(z/l)*s}}g-K>wi.itemsLimit&&this.itemsLimitError(),this.totalSize=j;let S;const ie=K<=this.$_endIndex&&g>=this.$_startIndex;if(ie)for(let F=0,W=D.length;F<W;F++)S=D[F],S.nr.used&&(e&&(S.nr.index=q[S.item[i]]),(S.nr.index==null||S.nr.index<K||S.nr.index>=g)&&this.unuseView(S));const le=ie?null:new Map;let oe,ee,ne;for(let F=K;F<g;F++){oe=m[F];const W=i?oe[i]:oe;if(W==null)throw new Error(`Key is ${W} on item (keyField is '${i}')`);if(S=L.get(W),!s&&!x[F].size){S&&this.unuseView(S);continue}ee=oe[v];let V=T.get(ee),O=!1;if(!S)ie?V&&V.length?S=V.pop():S=this.addView(D,F,oe,W,ee):(ne=le.get(ee)||0,(!V||ne>=V.length)&&(S=this.addView(D,F,oe,W,ee),this.unuseView(S,!0),V=T.get(ee)),S=V[ne],le.set(ee,ne+1)),L.delete(S.nr.key),S.nr.used=!0,S.nr.index=F,S.nr.key=W,S.nr.type=ee,L.set(W,S),O=!0;else if(!S.nr.used&&(S.nr.used=!0,O=!0,V)){const Z=V.indexOf(S);Z!==-1&&V.splice(Z,1)}S.item=oe,O&&(F===m.length-1&&this.$emit("scroll-end"),F===0&&this.$emit("scroll-start")),s===null?(S.position=x[F-1].accumulator,S.offset=0):(S.position=Math.floor(F/l)*s,S.offset=F%l*o)}return this.$_startIndex=K,this.$_endIndex=g,this.emitUpdate&&this.$emit("update",K,g,J,$),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:ie}},getListenerTarget(){let e=on(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:t}=this,s=t==="vertical";let l;if(this.pageMode){const o=e.getBoundingClientRect(),p=s?o.height:o.width;let v=-(s?o.top:o.left),i=s?window.innerHeight:window.innerWidth;v<0&&(i+=v,v=0),v+i>p&&(i=p-v),l={start:v,end:v+i}}else s?l={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:l={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return l},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Rt?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let t;const s=this.gridItems||1;this.itemSize===null?t=e>0?this.sizes[e-1].accumulator:0:t=Math.floor(e/s)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(e){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let s,l,o;if(this.pageMode){const p=on(this.$el),v=p.tagName==="HTML"?0:p[t.scroll],i=p.getBoundingClientRect(),z=this.$el.getBoundingClientRect()[t.start]-i[t.start];s=p,l=t.scroll,o=e+v+z}else s=this.$el,l=t.scroll,o=e;s[l]=o},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,t)=>e.nr.index-t.nr.index)}}};const Ci={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Pi={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function zi(e,t,s,l,o,p){const v=un("ResizeObserver"),i=ls("observe-visibility");return De((I(),M("div",{class:se(["vue-recycle-scroller",{ready:o.ready,"page-mode":s.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...m)=>p.handleScroll&&p.handleScroll(...m))},[e.$slots.before?(I(),M("div",Ci,[Fe(e.$slots,"before")],512)):ae("v-if",!0),(I(),Ce(Jt(s.listTag),{ref:"wrapper",style:we({[e.direction==="vertical"?"minHeight":"minWidth"]:o.totalSize+"px"}),class:se(["vue-recycle-scroller__item-wrapper",s.listClass])},{default:N(()=>[(I(!0),M(Ie,null,Je(o.pool,m=>(I(),Ce(Jt(s.itemTag),dn({key:m.nr.id,style:o.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${m.position}px) translate${e.direction==="vertical"?"X":"Y"}(${m.offset}px)`,width:s.gridItems?`${e.direction==="vertical"&&s.itemSecondarySize||s.itemSize}px`:void 0,height:s.gridItems?`${e.direction==="horizontal"&&s.itemSecondarySize||s.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[s.itemClass,{hover:!s.skipHover&&o.hoverKey===m.nr.key}]]},os(s.skipHover?{}:{mouseenter:()=>{o.hoverKey=m.nr.key},mouseleave:()=>{o.hoverKey=null}})),{default:N(()=>[Fe(e.$slots,"default",{item:m.item,index:m.nr.index,active:m.nr.used})]),_:2},1040,["style","class"]))),128)),Fe(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(I(),M("div",Pi,[Fe(e.$slots,"after")],512)):ae("v-if",!0),U(v,{onNotify:p.handleResize},null,8,["onNotify"])],34)),[[i,p.handleVisibilityChange]])}At.render=zi;At.__file="src/components/RecycleScroller.vue";var Ot={name:"DynamicScroller",components:{RecycleScroller:At},provide(){return typeof ResizeObserver<"u"&&(this.$_resizeObserver=new ResizeObserver(e=>{requestAnimationFrame(()=>{if(Array.isArray(e)){for(const t of e)if(t.target&&t.target.$_vs_onResize){let s,l;if(t.borderBoxSize){const o=t.borderBoxSize[0];s=o.inlineSize,l=o.blockSize}else s=t.contentRect.width,l=t.contentRect.height;t.target.$_vs_onResize(t.target.$_vs_id,s,l)}}})})),{vscrollData:this.vscrollData,vscrollParent:this,vscrollResizeObserver:this.$_resizeObserver}},inheritAttrs:!1,props:{...Tn,minItemSize:{type:[Number,String],required:!0}},emits:["resize","visible"],data(){return{vscrollData:{active:!0,sizes:{},keyField:this.keyField,simpleArray:!1}}},computed:{simpleArray:In,itemsWithSize(){const e=[],{items:t,keyField:s,simpleArray:l}=this,o=this.vscrollData.sizes,p=t.length;for(let v=0;v<p;v++){const i=t[v],m=l?v:i[s];let z=o[m];typeof z>"u"&&!this.$_undefinedMap[m]&&(z=0),e.push({item:i,id:m,size:z})}return e}},watch:{items(){this.forceUpdate()},simpleArray:{handler(e){this.vscrollData.simpleArray=e},immediate:!0},direction(e){this.forceUpdate(!0)},itemsWithSize(e,t){const s=this.$el.scrollTop;let l=0,o=0;const p=Math.min(e.length,t.length);for(let i=0;i<p&&!(l>=s);i++)l+=t[i].size||this.minItemSize,o+=e[i].size||this.minItemSize;const v=o-l;v!==0&&(this.$el.scrollTop+=v)}},beforeCreate(){this.$_updates=[],this.$_undefinedSizes=0,this.$_undefinedMap={},this.$_events=xi()},activated(){this.vscrollData.active=!0},deactivated(){this.vscrollData.active=!1},unmounted(){this.$_events.all.clear()},methods:{onScrollerResize(){this.$refs.scroller&&this.forceUpdate(),this.$emit("resize")},onScrollerVisible(){this.$_events.emit("vscroll:update",{force:!1}),this.$emit("visible")},forceUpdate(e=!1){(e||this.simpleArray)&&(this.vscrollData.sizes={}),this.$_events.emit("vscroll:update",{force:!0})},scrollToItem(e){const t=this.$refs.scroller;t&&t.scrollToItem(e)},getItemSize(e,t=void 0){const s=this.simpleArray?t??this.items.indexOf(e):e[this.keyField];return this.vscrollData.sizes[s]||0},scrollToBottom(){if(this.$_scrollingToBottom)return;this.$_scrollingToBottom=!0;const e=this.$el;this.$nextTick(()=>{e.scrollTop=e.scrollHeight+5e3;const t=()=>{e.scrollTop=e.scrollHeight+5e3,requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight+5e3,this.$_undefinedSizes===0?this.$_scrollingToBottom=!1:requestAnimationFrame(t)})};requestAnimationFrame(t)})}}};function $i(e,t,s,l,o,p){const v=un("RecycleScroller");return I(),Ce(v,dn({ref:"scroller",items:p.itemsWithSize,"min-item-size":s.minItemSize,direction:e.direction,"key-field":"id","list-tag":e.listTag,"item-tag":e.itemTag},e.$attrs,{onResize:p.onScrollerResize,onVisible:p.onScrollerVisible}),{default:N(({item:i,index:m,active:z})=>[Fe(e.$slots,"default",rs(cs({item:i.item,index:m,active:z,itemWithSize:i})))]),before:N(()=>[Fe(e.$slots,"before")]),after:N(()=>[Fe(e.$slots,"after")]),empty:N(()=>[Fe(e.$slots,"empty")]),_:3},16,["items","min-item-size","direction","list-tag","item-tag","onResize","onVisible"])}Ot.render=$i;Ot.__file="src/components/DynamicScroller.vue";var Cn={name:"DynamicScrollerItem",inject:["vscrollData","vscrollParent","vscrollResizeObserver"],props:{item:{required:!0},watchData:{type:Boolean,default:!1},active:{type:Boolean,required:!0},index:{type:Number,default:void 0},sizeDependencies:{type:[Array,Object],default:null},emitResize:{type:Boolean,default:!1},tag:{type:String,default:"div"}},emits:["resize"],computed:{id(){if(this.vscrollData.simpleArray)return this.index;if(this.vscrollData.keyField in this.item)return this.item[this.vscrollData.keyField];throw new Error(`keyField '${this.vscrollData.keyField}' not found in your item. You should set a valid keyField prop on your Scroller`)},size(){return this.vscrollData.sizes[this.id]||0},finalActive(){return this.active&&this.vscrollData.active}},watch:{watchData:"updateWatchData",id(e,t){if(this.$el.$_vs_id=this.id,this.size||this.onDataUpdate(),this.$_sizeObserved){const s=this.vscrollData.sizes[t],l=this.vscrollData.sizes[e];s!=null&&s!==l&&this.applySize(s)}},finalActive(e){this.size||(e?this.vscrollParent.$_undefinedMap[this.id]||(this.vscrollParent.$_undefinedSizes++,this.vscrollParent.$_undefinedMap[this.id]=!0):this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=!1)),this.vscrollResizeObserver?e?this.observeSize():this.unobserveSize():e&&this.$_pendingVScrollUpdate===this.id&&this.updateSize()}},created(){if(!this.$isServer&&(this.$_forceNextVScrollUpdate=null,this.updateWatchData(),!this.vscrollResizeObserver)){for(const e in this.sizeDependencies)this.$watch(()=>this.sizeDependencies[e],this.onDataUpdate);this.vscrollParent.$_events.on("vscroll:update",this.onVscrollUpdate)}},mounted(){this.finalActive&&(this.updateSize(),this.observeSize())},beforeUnmount(){this.vscrollParent.$_events.off("vscroll:update",this.onVscrollUpdate),this.unobserveSize()},methods:{updateSize(){this.finalActive?this.$_pendingSizeUpdate!==this.id&&(this.$_pendingSizeUpdate=this.id,this.$_forceNextVScrollUpdate=null,this.$_pendingVScrollUpdate=null,this.computeSize(this.id)):this.$_forceNextVScrollUpdate=this.id},updateWatchData(){this.watchData&&!this.vscrollResizeObserver?this.$_watchData=this.$watch("item",()=>{this.onDataUpdate()},{deep:!0}):this.$_watchData&&(this.$_watchData(),this.$_watchData=null)},onVscrollUpdate({force:e}){!this.finalActive&&e&&(this.$_pendingVScrollUpdate=this.id),(this.$_forceNextVScrollUpdate===this.id||e||!this.size)&&this.updateSize()},onDataUpdate(){this.updateSize()},computeSize(e){this.$nextTick(()=>{if(this.id===e){const t=this.$el.offsetWidth,s=this.$el.offsetHeight;this.applyWidthHeight(t,s)}this.$_pendingSizeUpdate=null})},applyWidthHeight(e,t){const s=~~(this.vscrollParent.direction==="vertical"?t:e);s&&this.size!==s&&this.applySize(s)},applySize(e){this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=void 0),this.vscrollData.sizes[this.id]=e,this.emitResize&&this.$emit("resize",this.id)},observeSize(){this.vscrollResizeObserver&&(this.$_sizeObserved||(this.vscrollResizeObserver.observe(this.$el),this.$el.$_vs_id=this.id,this.$el.$_vs_onResize=this.onResize,this.$_sizeObserved=!0))},unobserveSize(){this.vscrollResizeObserver&&this.$_sizeObserved&&(this.vscrollResizeObserver.unobserve(this.$el),this.$el.$_vs_onResize=void 0,this.$_sizeObserved=!1)},onResize(e,t,s){this.id===e&&this.applyWidthHeight(t,s)}},render(){return ss(this.tag,this.$slots.default())}};Cn.__file="src/components/DynamicScrollerItem.vue";const Ei=async(e,t,s)=>{if(!s)return!1;if(document.querySelector(`.virtual-item-wrap[data-pid="${t}"][data-active="true"]`))return!0;s.scrollToItem(e);let o=0;return new Promise(p=>{const{pause:v}=fn(()=>{if(o++,document.querySelector(`.virtual-item-wrap[data-pid="${t}"][data-active="true"]`)||o>=20)return v(),p(!0)},50)})};function Ri(){return{getParagraphText:t=>!t||!t.sentences?"":t.sentences.map(s=>s.contents.map(l=>l.content).join("")).join(" ")}}class Vi extends We{static get pluginName(){return"tmSubTitleIcon"}static get defaultConfig(){return{position:We.POSITIONS.CONTROLS_RIGHT,index:100}}constructor(t){super(t);const s=t.player.config.tmSubTitleIcon;this.status=s.show||!1}initIcons(){const{icons:t}=this;this.appendChild(".xgplayer-icon",t.subTitleHide),this.appendChild(".xgplayer-icon",t.subTitleShow)}registerIcons(){return{subTitleHide:{icon:'<span class="iconfont icon-shipinguanbizimu text-lg sub-title-common"></span>',class:"sub-title-hide"},subTitleShow:{icon:'<span class="iconfont icon-shipinzimu text-base sub-title-common"></span>',class:"sub-title-show"}}}afterCreate(){super.afterCreate(),this.initIcons(),this.onClick=()=>{var s,l;console.log("当前插件根节点点击事件");const t=this.getPlugin("texttrack");this.status=!this.status,this.status?(t.switchOnSubtitle(),(s=t.subTitles)==null||s._onTimeupdate(),this.animate(!0)):(t.subTitles.switchOff(),(l=t.subTitles)==null||l._onTimeupdate(),this.animate(!1))},this.bind(["touchend","click"],this.onClick),this.animate(this.status),this.player.on(Pt,()=>{const t=this.getPlugin("texttrack");this.status?(t.switchOnSubtitle(),this.animate(!0)):(t.subTitles.switchOff(),this.animate(!1))})}destroy(){super.destroy(),this.unbind(["touchend","click"],this.onClick)}animate(t){if(!this.player)return;const{i18nKeys:s}=this,l=this.find(".xg-tips");t?(this.setAttr("data-state","show"),l&&this.changeLangTextKey(l,s.TM_SUBTITLE_HIDE_TIPS)):(this.setAttr("data-state","hide"),l&&this.changeLangTextKey(l,s.TM_SUBTITLE_SHOW_TIPS))}render(){return`
      <xg-icon class='xgplayer-tm-subtitle'>
        <div class="xgplayer-icon">
        </div>
        ${bn(this,"TM_SUBTITLE_HIDE_TIPS",this.playerConfig.isHideTips)}
      </xg-icon>
      `}}class Mi extends We{static get pluginName(){return"tmMinimize"}static get defaultConfig(){return{position:We.POSITIONS.CONTROLS_RIGHT,index:99}}constructor(t){super(t)}initIcons(){const{icons:t}=this;this.appendChild(".xgplayer-icon",t.minimize)}registerIcons(){return{minimize:{icon:'<span class="iconfont icon-shipinyincang text-base"></span>',class:"minimize"}}}afterCreate(){super.afterCreate(),this.initIcons(),this.handlerMiniClick=this.hook("minimizeClick",()=>{}),this.onClick=()=>{this.handlerMiniClick()},this.bind(["touchend","click"],this.onClick),this.animate()}destroy(){super.destroy(),this.unbind(["touchend","click"],this.onClick)}animate(){if(!this.player)return;const{i18nKeys:t}=this,s=this.find(".xg-tips");this.setAttr("data-state","show"),s&&this.changeLangTextKey(s,t.TM_MINIMIZE_TIPS)}render(){return`
      <xg-icon class='xgplayer-tm-minimize'>
        <div class="xgplayer-icon">
        </div>
        ${bn(this,"TM_MINIMIZE_TIPS",this.playerConfig.isHideTips)}
      </xg-icon>
      `}}class rn extends We{static get pluginName(){return"TmControl"}static get defaultConfig(){return{position:We.POSITIONS.CONTROLS_CENTER}}constructor(t){var s;super(t),this.vm=null,this.id=Date.now(),this.player=t.player,this.dynamicProgressBar=((s=this.player.config.tmControl)==null?void 0:s.dynamicProgressBar)??!1}beforePlayerInit(){}afterPlayerInit(){}afterCreate(){const t=this.find(".controls-el"),s=us(xn,{player:this.player,onlyShowProgress:!0,dynamicProgressBar:this.dynamicProgressBar});this.vm=s.mount(t)}destroy(){super.destroy()}render(){return`<div class='tm-control-box flex-1 w-full !px-4 h-5 flex items-center'>
        <div class='controls-el flex-1'></div>
    </div>`}}function Ai(e,t,s){const l=b(null),o=b(null),p=b(0),v=b(null),i=b({paraIndex:-1,sentIndex:-1,contentIndex:-1}),m=dt("(min-width: 768px)"),{locale:z}=ft(),x=pn("locale",()=>z.value),L=pe(()=>["he-IL","ar-SA"].includes(x.value)),T=b([]),{fileType:D}=Ze(s.fileBaseInfo),q=pe(()=>{const a=["MP4","MOV","MPEG","WMV"];return m.value&&!!a.find(u=>u.toLowerCase()===D.value.toLowerCase())}),K=a=>{p.value=parseFloat(a.toFixed(3))},g=(a,u="text-black",r="font-size:1rem")=>()=>yn.createDom("div",`<span class="iconfont ${a}" style="${r}"></span>`,{},u),j={width:"100%",height:"100%",miniprogress:!0,keyShortcut:!1,seekedStatus:"auto",customDuration:s.fileBaseInfo.duration,volume:{default:.6,showValueLabel:!0,index:1e3},commonStyle:{progressColor:"#E8E8F1",playedColor:"#3470FF",cachedColor:"",sliderBtnStyle:{background:"#3470FF",boxShadow:"none"},volumeColor:"#3470FF"},videoConfig:{crossOrigin:"anonymous"}},J=a=>a.map(u=>({text:u+"X",rate:parseFloat(u)})),$=(a,u,r)=>{var y,h;q.value?o.value=new nn({...j,lang:u.value,id:"mse",url:a.fileUrl,fluid:!0,plugins:[Ds,Vi,Mi,...L.value?[rn]:[]],ignores:["cssFullScreen",...L.value?["progress"]:[]],leavePlayerTime:0,controls:{initShow:!0,mode:"normal"},tmControl:{dynamicProgressBar:!0},volume:{default:.6,showValueLabel:!0,index:1,position:We.POSITIONS.CONTROLS_LEFT},playbackRate:{index:999,hidePortrait:!1,listType:"middle",list:J(["3.0","2.0","1.5","1.25","1.0","0.75","0.5"])},textTrack:{isShowIcon:!1,debugger:!1,isIcons:!0,style:{follow:!0,mode:"bg",followBottom:50,fitVideo:!0,offsetBottom:6,baseSizeX:49,baseSizeY:28,minSize:14,minMobileSize:12,line:"double",fontColor:"#fff"},list:[{id:"subTitleId",language:u.value,text:"subTitle",default:!0,list:[{start:((y=r.value[0])==null?void 0:y.start)||0,end:((h=r.value[r.value.length-1])==null?void 0:h.end)||0,list:r.value}]}]},tmSubTitleIcon:{show:!1},icons:{play:g("icon-shipinbofang1","text-white","font-size:1.125rem"),pause:g("icon-shipingzanting","text-white","font-size:1.125rem"),volumeSmall:g("icon-shipinyinliangxiao","text-white","margin-inline-start: 0.375rem"),volumeLarge:g("icon-shipinyinliangda","text-white","font-size:0.875rem;margin-inline-start: 0.375rem"),volumeMuted:g("icon-shipinjingyin","text-white","margin-inline-start: 0.375rem"),fullscreen:g("icon-shipinquanpingmu","text-white"),exitFullscreen:g("icon-shipinsuoxiaopingmu","text-white")}}):l.value=new nn({...j,lang:u.value,id:"audioID",url:a.fileUrl,seekedStatus:"auto",mediaType:"audio",plugins:[...L.value?[rn]:[]],ignores:["start","cssFullScreen","fullscreen","pip","enter","replay","pc","loading","poster",...L.value?["progress","mobile"]:[]].filter(Boolean),playbackRate:{index:999,listType:"middle",list:J(["3.0","2.0","1.5","1.25","1.0","0.75","0.5"])},controls:{root:document.getElementById("audio-crt"),initShow:!0,mode:"flex"},icons:{play:g("icon-bofang","text-black","font-size: 1.375rem"),pause:g("icon-zanting","text-black","font-size: 1.375rem"),volumeSmall:g("icon-yinliang","text-black","font-size: 1.2rem; margin-inline-start: 0.375rem"),volumeLarge:g("icon-shipinyinliangda","text-black","font-size: 1.05rem;margin-inline-start: 0.375rem"),volumeMuted:g("icon-shipinjingyin","text-black","font-size: 1.2rem; margin-inline-start: 0.375rem")}}),ie(),le()},S=()=>{var u,r;if(!q.value)return;ne(),o.value.getPlugin("texttrack").updateSubtitles([{id:"subTitleId",language:"en",text:"subTitle",default:!0,list:[{start:((u=T.value[0])==null?void 0:u.start)||0,end:((r=T.value[T.value.length-1])==null?void 0:r.end)||0,list:T.value}]}])},ie=()=>{const a=s.fileBaseInfo.lastPlayTime,u=s.fileBaseInfo.lastPlayVolume,r=s.fileBaseInfo.lastPlayRate;q.value?o.value.on(Pt,()=>{a&&(o.value.currentTime=+a),+u==0?o.value.muted=!0:o.value.volume=+u,r&&(o.value.playbackRate=+r)}):l.value.on(Pt,()=>{a&&(l.value.currentTime=+a),+u==0?l.value.muted=!0:l.value.volume=+u,r&&(l.value.playbackRate=+r)})},le=()=>{if(q.value){const a=o.value.getPlugin("controls"),u=h=>{if(h.target===a.root){if(o.value.paused)return o.value.play();o.value.pause()}};a.bindEL("click",u),o.value.getPlugin("tmMinimize").useHooks("minimizeClick",()=>{t.value=!1});const r=()=>{var w;i.value={paraIndex:-1,sentIndex:-1,contentIndex:-1};const h=((w=o.value)==null?void 0:w.currentTime)||0;s.fileBaseInfo.isHalfHour&&h>30*60||(K(h),W())};o.value.on(ot,r);const y=()=>{parseInt(p.value)>=parseInt(s.fileBaseInfo.duration)&&o.value.replay()};o.value.on(rt,y),o.value.on(tn,()=>{a.unbindEL("click",u),o.value.off(ot,r),o.value.off(rt,y)})}else{const a=()=>{var y;i.value={paraIndex:-1,sentIndex:-1,contentIndex:-1};const r=((y=l.value)==null?void 0:y.currentTime)||0;s.fileBaseInfo.isHalfHour&&r>1800||(K(r),W(),r>=s.fileBaseInfo.duration&&(l.value.currentTime=s.fileBaseInfo.duration,l.value.pause()))};l.value.on(ot,a);const u=()=>{parseInt(p.value)>=parseInt(s.fileBaseInfo.duration)&&l.value.replay()};l.value.on(rt,u),l.value.on(tn,()=>{l.value.off(ot,a),l.value.off(rt,u)})}},oe=()=>{var w;if(!e.value||!e.value.paragraphs)return[];const a=ee();if(!a.length)return[];a.sort((C,R)=>parseFloat(C.start_time)-parseFloat(R.start_time));const u=[],r=[];a.forEach(C=>{const R=+C.start_time,Y=+C.stop_time;r.push({time:R,type:"start",item:C}),r.push({time:Y,type:"end",item:C})}),r.sort((C,R)=>C.time-R.time);const y=new Set;let h=((w=r[0])==null?void 0:w.time)||0;for(let C=0;C<r.length;C++){const R=r[C],Y=R.time;if(y.size>0&&Y>h){const be={start:+h,end:+Y,text:Array.from(y).map(de=>de.content),textObj:Array.from(y).map(de=>({content:de.content,speaker:de.speaker}))};(new Set(Array.from(y).map(de=>de.speaker)).size>1||y.size===1&&Y-h>.01)&&u.push(be)}R.type==="start"?y.add(R.item):y.delete(R.item),h=Y}return u},ee=()=>{if(!e.value||!e.value.paragraphs)return[];const a=[];return e.value.paragraphs.forEach(u=>{u.sentences&&u.sentences.forEach(r=>{if(!r.contents||r.contents.length===0)return;const y=[];let h="";for(const w of r.contents)h+=w.content;y.push({sid:r.sid,start_time:r.start_time,stop_time:r.stop_time,content:h}),y.forEach(w=>{a.push({...w,speaker:u.pid})})})}),a},ne=()=>{!e.value||!q.value||(T.value=oe())},W=ds(()=>{var a,u,r,y,h;try{if(!((u=(a=e.value)==null?void 0:a.paragraphs)!=null&&u.length)||(r=e.isEdit)!=null&&r.value||(q.value?!((y=o.value)!=null&&y.paused):!((h=l.value)!=null&&h.paused)))return;const C=p.value;if(typeof C!="number"||C<0)return;const R=e.value.paragraphs,Y=Z(R,C);if(console.log("🚀 ~ 活跃单词的结果  🚀",Y),!Y)return;X(Y)}catch(w){console.warn("Error in scrollToActiveWord:",w)}},100),V=a=>{var h,w;const u=performance.now(),r=[];for(let C=0;C<a.length;C++){const R=a[C];if((h=R.sentences)!=null&&h.length)for(let Y=0;Y<R.sentences.length;Y++){const be=R.sentences[Y];if((w=be.contents)!=null&&w.length)for(let de=0;de<be.contents.length;de++){const ve=be.contents[de];if(ve.start_time!==void 0){const Se=+ve.start_time,He=ve.stop_time?+ve.stop_time:Se+.1;r.push({startTime:Se,stopTime:He,paraIndex:C,sentIndex:Y,contentIndex:de})}}}}r.sort((C,R)=>C.startTime-R.startTime);const y=performance.now();return console.debug(`Time index built: ${r.length} items in ${(y-u).toFixed(2)}ms`),r};let O=null;const Z=(a,u)=>{if(O||(O=V(a)),!O.length)return null;const r=he(O,u);if(r)return{...r,isActive:!0};const y=k(O,u);return y?{...y,isActive:!1}:null},he=(a,u)=>{let r=0,y=a.length-1;for(;r<=y;){const h=Math.floor((r+y)/2),w=a[h];if(u>=w.startTime&&u<w.stopTime)return w;u<w.startTime?y=h-1:r=h+1}return null},k=(a,u)=>{let r=0,y=a.length-1,h=null,w=1/0;for(;r<=y;){const C=Math.floor((r+y)/2),R=a[C],Y=Math.abs(u-R.startTime);Y<w&&(w=Y,h={...R,minDiff:w}),u<R.startTime?y=C-1:r=C+1}if(r<a.length){const C=Math.abs(u-a[r].startTime);C<w&&(h={...a[r],minDiff:C})}if(y>=0){const C=Math.abs(u-a[y].startTime);C<w&&(h={...a[y],minDiff:C})}return h},X=async a=>{try{const{paraIndex:u,sentIndex:r,contentIndex:y}=a,h=e.value.paragraphs;if(!h[u]){console.warn(`Invalid paragraph index: ${u}`);return}const w=h[u].pid,C=document.querySelector(`.virtual-item-wrap[data-pid="${w}"][data-active="true"]`);if(C)Q(C,r,y);else{await B(u,w);let R=document.querySelector(`.virtual-item-wrap[data-pid="${w}"][data-active="true"]`);Q(R,r,y)}}catch(u){console.warn("Error in scrollToTargetWord:",u)}},Q=(a,u,r)=>{try{(a.querySelector(`span[data-sent-index="${u}"][data-content-index="${r}"]`)||a).scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}catch(y){console.warn("Error in scrollToSpecificWord:",y)}},G=(a,u,r,y)=>{if(i.value={paraIndex:a,sentIndex:u,contentIndex:r},y.start_time!==void 0){const h=+y.start_time;q.value?o.value.currentTime=h:l.value.currentTime=h}},B=async(a,u)=>{if(!v.value)return!1;if(document.querySelector(`.virtual-item-wrap[data-pid="${u}"][data-active="true"]`))return!0;v.value.scrollToItem(a);let y=0;return new Promise(h=>{const{pause:w}=fn(()=>{if(y++,document.querySelector(`.virtual-item-wrap[data-pid="${u}"][data-active="true"]`)||y>=20)return w(),h(!0)},50)})};return{playerAudio:l,playerVideo:o,currentTime:p,dynamicScroller:v,allSegments:T,initPlayers:$,updateOverlappingSegments:ne,handleWordClick:G,isWordActive:(a,u,r,y)=>{const h=a.start_time!==void 0&&a.stop_time!==void 0&&p.value>=+a.start_time&&p.value<+a.stop_time;return i.value.paraIndex===u&&i.value.sentIndex===r&&i.value.contentIndex===y||h},scrollToParagraph:B,setupI18nWatch:(a,u)=>{Ue(a,()=>{const r=u("en-US");sn.use({LANG:"en",TEXT:r.videoLang||{}});let y=u(a.value);if(y.videoLang){const w={LANG:a.value,TEXT:y.videoLang||{}};sn.use(w)}},{immediate:!0})},isVideo:q,updateSubtitle:S,isRtl:L}}function Oi(e){const t=b(null),s=b(null),l=b(null),o=b(null),p=b(!1),v=b(0),i=b(0),m=b(0),z=b(0),x=dt("(min-width: 768px)"),L=b(!1),T=fs(),D=mn(),{isShowVideo:q,translateLang:K,fileType:g}=Ze(e.fileBaseInfo);q.value??(q.value=!0),K.value??(K.value="");const{locale:j}=ft(),J=pn("locale",()=>j.value),$=pe(()=>["he-IL","ar-SA"].includes(J.value)),S=b(null),ie=450,le=10,oe=b(0),ee=pe(()=>!!["MP4","MOV","MPEG","WMV"].find(u=>u.toLowerCase()===g.value.toLowerCase())),ne=pe(()=>O.value?{"grid-template-columns":"1fr 1px 1fr",position:"relative",direction:$.value?"rtl":"ltr"}:{"grid-template-columns":"1fr","grid-template-rows":"1fr",direction:$.value?"rtl":"ltr"}),F=pe(()=>{const a=p.value?i.value:m.value;return{transform:`translateX(${$.value?-a:a}px)`,transition:p.value?"none":"transform 0.15s","will-change":p.value?"transform":"auto"}}),W=pe(()=>{const a=p.value?i.value:m.value;return $.value?{width:`calc(100% + ${a}px)`,transition:p.value?"none":"width 0.15s","will-change":p.value?"width":"auto"}:{width:`calc(100% + ${a}px)`,transition:p.value?"none":"width 0.15s","will-change":p.value?"width":"auto"}}),V=pe(()=>{const a=p.value?i.value:m.value;return $.value?{transform:`translateX(${-a}px)`,transition:p.value?"none":"transform 0.15s",width:`calc(100% - ${a}px)`,"will-change":p.value?"transform, width":"auto"}:{transform:`translateX(${a}px)`,transition:p.value?"none":"transform 0.15s",width:`calc(100% - ${a}px)`,"will-change":p.value?"transform, width":"auto"}}),O=pe(()=>ee.value&&x.value&&q.value&&!K.value),Z=()=>{m.value=0,i.value=0};Ue(()=>O.value,a=>{a===!1&&Z()}),Ue($,()=>{Z()});const he=()=>{x.value&&(L.value=!0)},k=()=>{p.value||(L.value=!1)},X=a=>{!L.value||!x.value||!t.value||(p.value=!0,v.value=a.clientX,z.value=t.value.offsetWidth/2,i.value=m.value,window.addEventListener("mousemove",Q,{passive:!0}),window.addEventListener("mouseup",G),document.body.classList.add("no-select"),t.value&&t.value.classList.add("hardware-accelerated"))},Q=a=>{if(!p.value||!t.value)return;const u=Date.now();u-oe.value<le||(oe.value=u,S.value&&cancelAnimationFrame(S.value),S.value=requestAnimationFrame(()=>{const r=a.clientX-v.value,y=$.value?-r:r,h=i.value+y;i.value=Math.round(h);const R=t.value.offsetWidth/2-ie;i.value=Math.max(-R,Math.min(i.value,R)),v.value=a.clientX}))},G=()=>{p.value=!1,L.value=!1,m.value=i.value,S.value&&(cancelAnimationFrame(S.value),S.value=null),window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",G),document.body.classList.remove("no-select"),t.value&&t.value.classList.remove("hardware-accelerated")},B=()=>{q.value=!q.value},re=()=>{const a=window.sessionStorage.getItem("jumpTranscriptOrigin");if(a&&a.startsWith("/"))return window.sessionStorage.removeItem("jumpTranscriptOrigin"),T.push({path:a});T.push({path:D("/home")})},d=()=>{T.push(D("/accountSettings?type=2"))};return Mt(()=>{const a=document.createElement("style");a.innerHTML=`
      .hardware-accelerated * {
        transform: translateZ(0);
      }
    `,document.head.appendChild(a)}),{container:t,resizer:s,leftPanel:l,rightPanel:o,isDragging:p,isDesktop:x,dragEnabled:L,isShowVideo:q,langId:K,displayVideo:O,gridStyle:ne,resizerStyle:F,leftPanelStyle:W,rightPanelStyle:V,resetLayout:Z,enableDrag:he,disableDrag:k,handleDragStart:X,handelToggleVideo:B,handleBack:re,handleJumpUpgrade:d}}function Li(e,t,s,l,o,p,v){const i=b(!1);e.isEdit=i;const m=b({paraId:null,sentIndex:null,contentIndex:null}),z=b([]),x=b(-1);b({timestamp:0,paraId:null,sentIndex:null,contentIndex:null});const L=b(!1),T=pe(()=>x.value>=0),D=pe(()=>x.value<z.value.length-1),q=d=>{const a=window.getSelection();if(a.rangeCount===0)return!1;const u=a.getRangeAt(0);return u.startOffset===0&&u.collapsed},K=d=>{const a=window.getSelection();if(a.rangeCount===0)return!1;const u=a.getRangeAt(0);return u.startContainer.nodeType===Node.TEXT_NODE?u.startOffset===u.startContainer.length&&u.collapsed:!1},g=d=>{let a=d.previousElementSibling;for(;a;){if(a.childNodes.length>0)return a;a=a.previousElementSibling}return null},j=d=>{let a=d.nextElementSibling;for(;a;){if(a.childNodes.length>0)return a;a=a.nextElementSibling}return null},J=d=>{const a=window.getSelection(),u=document.createRange();d.childNodes.length>0?u.setStart(d.childNodes[0],0):u.setStart(d,0),u.collapse(!0),a.removeAllRanges(),a.addRange(u)},$=d=>{const a=window.getSelection(),u=document.createRange();if(d.childNodes.length>0){const r=d.childNodes[d.childNodes.length-1];r.nodeType===Node.TEXT_NODE?u.setStart(r,r.length):u.setStartAfter(r)}else u.setStart(d,0);u.collapse(!0),a.removeAllRanges(),a.addRange(u)},S=(d,a,u)=>{let r=null;if(a===-1){if(r=g(d),console.log("🚀 ~ file: useTranscriptEdit.js method: moveFocus line: 127 🚀",r),!r)return;$(r)}else if(a===1){if(r=j(d),!r)return;J(r)}if(r){r.focus();const{cid:y,contentIndex:h,pid:w,sentIndex:C}=r.dataset;F(w,+C,+h,{cid:y},u)}},ie=()=>{i.value=!0,z.value=[],x.value=-1},le=async d=>{const{transcriptApi:a}=await je(async()=>{const{transcriptApi:u}=await import("./86auEJMD.js");return{transcriptApi:u}},__vite__mapDeps([0,1,2,3]),import.meta.url);await a.editFileTranscriptInfo({pid:d.pid,fileId:v.fileBaseInfo.id,taskId:v.fileBaseInfo.taskId,editContent:JSON.stringify(d.sentences)})},oe=()=>{i.value=!1,ee(),z.value=[],x.value=-1,ne.value=""},ee=()=>{m.value={paraId:null,sentIndex:null,contentIndex:null}},ne=b(null),F=(d,a,u,r,y)=>{y&&ne.value&&ne.value!==r.cid&&Z.flush(),L.value=!0,m.value={paraId:d,sentIndex:a,contentIndex:u},ne.value=r.cid,typeof s=="function"&&s(d,a,u,r)},W=d=>d.replace(/\r\n|\n|\r/g,""),V=(d,a,u)=>m.value.paraId===d&&m.value.sentIndex===a&&m.value.contentIndex===u,Z=ps(async(d,a,u,r,y)=>{const h=d.target,w=window.getSelection(),R=w.getRangeAt(0).endOffset;let Y=h.innerText;Y=W(Y),h.innerText=Y;let be=y.content;const de=e.value.paragraphs.find(ve=>ve.pid===a);if(de&&de.sentences[u]&&de.sentences[u].contents[r]){de.sentences[u].contents[r].content=Y;const ve=Date.now();he({paraId:a,sentIndex:u,contentIndex:r,oldContent:be,newContent:Y,timestamp:ve})}Be(()=>{try{if(!Y)S(h,-1,d);else{h.focus();const ve=document.createRange(),Se=h.firstChild||h;ve.setStart(Se,Math.min(R,Se.length||0)),ve.setEnd(Se,Math.min(R,Se.length||0)),w.removeAllRanges(),w.addRange(ve),console.log("🚀 ~ file: useTranscriptEdit.js method:  line: 197 🚀 selection end")}}catch(ve){console.error("Error restoring cursor position:",ve)}}),o(),le(de)},300),he=d=>{if(x.value<z.value.length-1&&(z.value=z.value.slice(0,x.value+1)),d.oldContent&&d.newContent){let a=0;const u=Math.min(d.oldContent.length,d.newContent.length);for(;a<u&&d.oldContent.charAt(a)===d.newContent.charAt(a);)a++;d.cursorPosition=a}z.value.push(d),x.value=z.value.length-1},k=async()=>{if(!T.value)return;const d=z.value[x.value],a=e.value.paragraphs.findIndex(r=>r.pid===d.paraId),u=e.value.paragraphs[a];u&&u.sentences[d.sentIndex]&&u.sentences[d.sentIndex].contents[d.contentIndex]&&(u.sentences[d.sentIndex].contents[d.contentIndex].content=d.oldContent,F(d.paraId,d.sentIndex,d.contentIndex,d),t.value&&typeof l=="function"&&await l(a,d.paraId,t.value),Be(()=>{let r=null;const y=document.querySelector(`[data-pid="${d.paraId}"]`);if(y){const h=`span[data-sent-index="${d.sentIndex}"][data-content-index="${d.contentIndex}"]`,w=y.querySelectorAll(h);w.length>0&&(r=w[0])}if(!r){const h=`.transcript-content-wrap span[data-sent-index="${d.sentIndex}"][data-content-index="${d.contentIndex}"]`,w=document.querySelectorAll(h);for(const C of w)if(C.innerText===d.oldContent){r=C;break}}r&&(r.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{r.focus();const h=document.createRange(),w=window.getSelection(),C=r.firstChild||r;let R=d.cursorPosition||0;R=Math.min(R,C.length||0);try{h.setStart(C,R),h.setEnd(C,R),w.removeAllRanges(),w.addRange(h)}catch(Y){console.error("Error setting cursor position:",Y)}},100))})),x.value--,o(),le(u)},X=async()=>{if(!D.value)return;x.value++;const d=z.value[x.value],a=e.value.paragraphs.findIndex(r=>r.pid===d.paraId),u=e.value.paragraphs[a];u&&u.sentences[d.sentIndex]&&u.sentences[d.sentIndex].contents[d.contentIndex]&&(u.sentences[d.sentIndex].contents[d.contentIndex].content=d.newContent,F(d.paraId,d.sentIndex,d.contentIndex,d),t.value&&typeof l=="function"&&await l(a,d.paraId,t.value),Be(()=>{let r=null;const y=document.querySelector(`[data-pid="${d.paraId}"]`);if(y){const h=`span[data-sent-index="${d.sentIndex}"][data-content-index="${d.contentIndex}"]`,w=y.querySelectorAll(h);w.length>0&&(r=w[0])}if(!r){const h=`.transcript-content-wrap span[data-sent-index="${d.sentIndex}"][data-content-index="${d.contentIndex}"]`,w=document.querySelectorAll(h);for(const C of w)if(C.innerText===d.newContent){r=C;break}}r&&(r.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{r.focus();const h=document.createRange(),w=window.getSelection(),C=r.firstChild||r;let R=0;if(d.cursorPosition!==void 0)if(d.newContent&&d.oldContent){const Y=d.newContent.length-d.oldContent.length;Y>0?R=Math.min(d.cursorPosition+Y,C.length||0):R=Math.min(d.cursorPosition,C.length||0)}else R=Math.min(d.cursorPosition,C.length||0);try{h.setStart(C,R),h.setEnd(C,R),w.removeAllRanges(),w.addRange(h)}catch(Y){console.error("Error setting cursor position:",Y)}},100))}),o(),le(u))},Q=async d=>{d.target,d.key==="ArrowLeft"&&q()?(d.preventDefault(),S(d.target,-1,d)):d.key==="ArrowRight"&&K()&&(d.preventDefault(),S(d.target,1,d)),d.key==="Backspace"&&q()&&(d.preventDefault(),S(d.target,-1,d))},G=b(!1);return{isEditRightTranscript:i,activeEditElement:m,canUndo:T,canRedo:D,handleEditRightTranscript:ie,handleSaveRightTranscript:oe,handleContentEdit:Z,setActiveEditElement:F,isActiveEditElement:V,resetActiveEditElement:ee,undoOperation:k,redoOperation:X,handleDocumentClick:d=>{if(!i.value)return;if(L.value&&!G.value){L.value=!1;return}G.value=!1;const a=d.target;if(a.closest(".transcript-content-wrap .content-span-parent-node")){if(a.tagName==="SPAN"&&a.getAttribute("contenteditable")==="true")return;if(a.tagName==="DIV"&&a.hasAttribute("data-pid")){const r=a.children;let y=null;for(let h=r.length-1;h>=0;h--){const w=r[h];if(w.textContent&&w.textContent.trim()!==""){y=w;break}}if(y||(y=a.firstChild),y){y.focus();const h=y.dataset,{cid:w,contentIndex:C,pid:R,sentIndex:Y}=h;F(R,+Y,+C,{cid:w},d),G.value=!0;return}}ee()}else ee()},editHistory:z,currentHistoryIndex:x,handleKeyDown:Q,handleEnterEdit:()=>{console.log("🚀 handleEnterEdit 🚀")},filterEnterStr:W}}function Di(e,t,s,l){const o=b(!1),p=b(!1),v=b(""),i=b(""),m=b(""),z=b(""),x=b(0),L=b(null),T=b(!1),D=b(""),q=b(null),K=b(null),{isShowSpeaker:g}=Ze(l.fileBaseInfo);g.value??(g.value=!0);const j=b(It(t.value));Ue(t,k=>{j.value=It(k)},{deep:!0}),Ue(T,k=>{k&&setTimeout(()=>{var Q;const X=(Q=K.value)==null?void 0:Q.wrapRef;if(X){const G=X.querySelector(".is-active");G&&G.scrollIntoView({block:"center"})}},10)});let J=Math.max(...j.value.map(k=>k.id));const $=pe(()=>j.value),S=b({}),ie=pe(()=>j.value.reduce((k,X)=>(k[X.id]=X.name,k),{})),le=async k=>{const{transcriptApi:X}=await je(async()=>{const{transcriptApi:Q}=await import("./86auEJMD.js");return{transcriptApi:Q}},__vite__mapDeps([0,1,2,3]),import.meta.url);await X.editSpeaker({fileId:l.fileBaseInfo.id,taskId:l.fileBaseInfo.taskId,pid:D.value,applyAll:x.value,...k})},oe=pe(()=>{if(!j.value.length)return!1;const k=j.value.find(X=>X.id===v.value);return k&&k.count>1}),ee=(k,X,Q)=>{if(Q)return;T.value=!0,D.value=X,v.value=k;const G=j.value.find(B=>B.id===k);G?i.value=G.id:i.value=-1},ne=(k=!1)=>{i.value="",v.value="",x.value=0,T.value=!1,D.value="",k&&(j.value=It(t.value),S.value={})};return{speakerDialogVisible:o,editSpeakerDialogVisible:p,selectedSpeakerId:i,originSelectedSpeakerId:v,editingSpeakerId:m,editingSpeakerName:z,applyToAllMatching:x,speakerPopoverRef:L,speakerPopoverVisible:T,selectedPid:D,speakerBtnRef:q,isShowSpeaker:g,speakers:j,uniqueSpeakers:$,uniqueSpeakersMap:ie,hasDuplicateSpeakers:oe,handleSpeakerPopoverShow:ee,handleSpeakerPopoverHide:ne,confirmSpeakerSelection:async()=>{if(i.value==="")return ne();let k=j.value.find(B=>B.id===i.value);if(!k)return ne();const X=j.value.find(B=>B.id===v.value),Q=j.value.find(B=>B.id===i.value);if(x.value)Q.count=Q.count+X.count,X.count=0;else{const B=S.value[Q.id];if(B){const re={...B};re.count=1,j.value.push(re),i.value=re.id,k=re,X.name=re.originName}else Q.count++;X.count--}const G={sourceSpeakerId:v.value,targetSpeakerId:i.value,targetSpeaker:k.name,originSpeakers:j.value.map(({id:B,name:re})=>({speakerId:B,speaker:re}))};if(await le(G),s("updateSpeakers",j.value.map(({id:B,name:re,count:d})=>({id:B,name:re,count:d}))),x.value)e.value&&e.value.paragraphs&&e.value.paragraphs.forEach(B=>{B.speakerId===v.value&&(B.speakerId=i.value,B.speaker=k.name)});else{const B=e.value.paragraphs.find(re=>re.pid===D.value);B&&(B.speakerId=i.value,B.speaker=k.name)}ne()},openEditSpeakerDialog:(k=null)=>{k?(m.value=k.id,z.value=k.name):(m.value="",z.value=""),p.value=!0},selectSpeaker:k=>{i.value=k},confirmEditSpeaker:()=>{const k=z.value.trim();if(!k){p.value=!1;return}let X=m.value,Q=k;if(m.value===""){X=++J;const G=j.value.find(B=>B.name===Q);G?X=G.id:j.value.push({id:X,name:Q,count:0})}else{const G=j.value.find(B=>B.name===Q);if(G)X=G.id;else{const B=j.value.find(re=>re.id===m.value);B.count>1&&(S.value[B.id]={id:++J,name:Q,originId:B.id,originName:B.name,count:0}),B.name=Q}}i.value=X,p.value=!1,o.value=!0},handleShowSpeaker:()=>{g.value=!g.value},handleOutsideClick:k=>{if(!D.value)return;const X=document.querySelector("#__nuxt"),Q=k.target;X!=null&&X.contains(Q)&&ne(!0)},editAddSpeakersMap:S,scrollbarRef:K}}function Fi(e){const{fileName:t,isShowTimestamp:s,gmtCreateTime:l}=Ze(e.fileBaseInfo);s.value??(s.value=!0),l.value??(l.value="");const o=b(!1),p=b(null),v=dt("(min-width: 768px)"),i=()=>{o.value||(o.value=!0,setTimeout(()=>{if(p.value){p.value.focus();const T=document.createRange(),D=window.getSelection();T.selectNodeContents(p.value),T.collapse(!1),D.removeAllRanges(),D.addRange(T)}},10))},m=async()=>{try{if(p.value){const T=p.value.textContent.trim(),{useFolderApi:D}=await je(async()=>{const{useFolderApi:q}=await import("./O9dB02R4.js");return{useFolderApi:q}},__vite__mapDeps([4,3,1,2]),import.meta.url);await D.renameFile({id:e.fileBaseInfo.id,taskId:e.fileBaseInfo.taskId,fileName:T}),t.value=T}o.value=!1}catch(T){console.log("🚀 ~ file: useFileInfo.js method: saveFileName line: 48 🚀",T)}};return{fileName:t,fileUploadTime:l,isEditing:o,fileNameElement:p,isShowTimestamp:s,startEditing:i,saveFileName:m,cancelEditing:()=>{v.value?(p.value&&(p.value.textContent=t.value),o.value=!1):m()},handleShowTimestamp:()=>{s.value=!s.value},formatSecondsFromMs:T=>{const D=Math.floor(T/86400),q=Math.floor(T%86400/3600),K=Math.floor(T%3600/60),g=parseInt(T%60),j=D>0?`${D}d `:"",J=q.toString().padStart(2,"0"),$=K.toString().padStart(2,"0"),S=g.toString().padStart(2,"0");return D>0?`${j}${J}:${$}:${S}`:`${J}:${$}:${S}`}}}function Ni(e){const t=b(""),s=b(null),l=b(null),o=b(null),p=({id:x="",name:L="",langCode:T=""})=>{var D;t.value=x,(D=l.value)==null||D.hide(),e("translate",{langId:x,langCode:T})},v=()=>{setTimeout(()=>{var x;(x=s.value)==null||x.scrollToSelectedLanguage()},50)},i=b(0);let m=new IntersectionObserver(x=>{x.forEach(L=>{if(L.isIntersecting){const T=L.intersectionRect;let D=document.documentElement.style.fontSize;if(D?D=parseFloat(D):D=16,T.height>0){const q=document.querySelector(".vue-recycle-scroller"),K=document.querySelector(".vue-recycle-scroller__item-wrapper");let g=0;const j=(q==null?void 0:q.clientHeight)||0,J=+K.style.minHeight.replace("px","");j>J&&(g=j-J,console.log("🚀 ~ file: 外层与内层  差值 🚀",g)),i.value=((T.height+g)/D).toFixed(3)}else i.value=0}else i.value=0})},{threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1]});return{langId:t,langChooseV1Ref:s,langChoosePopoverRef:l,handleTranslateLangChoose:p,handleLangPopShow:v,handleScrollEnd:()=>{Be(()=>{o.value&&m.observe(o.value)})},upgradeVisibleHeight:i,upgradeTipRef:o}}const Bi={class:"transcript-box relative flex w-full flex-col text-sm"},ji={class:"share-login"},Ui={class:"content-box flex flex-1 flex-col overflow-hidden"},Wi={key:0,class:"flex min-h-[3.75rem] w-full flex-row items-center border-b border-solid border-borderColor px-4 py-3"},Hi={class:"left-box flex flex-1 items-center overflow-hidden"},qi={key:0,class:"icon-wrap me-2 flex cursor-pointer items-center rounded-sm text-lg text-black hover:bg-[#D3D3D3]"},Xi={class:"file-wrap flex-1 overflow-hidden"},Ki={class:"file-name line-clamp-1 break-all leading-5 text-black"},Yi=["contenteditable","title"],Gi={key:1,class:"file-text text-base font-medium"},Ji={class:"file-upload-time text-sm text-fontColor"},Zi={class:"right-box relative ms-20 flex h-8 min-w-[10rem]"},Qi={key:0,class:"absolute bottom-[50%] right-0 flex translate-y-[50%]"},ea={key:0},ta={class:"max-w-20 truncate leading-4"},na={class:"flex h-8 min-w-20 items-center justify-center"},sa={key:0,class:"absolute bottom-[50%] right-0 flex translate-y-[50%]"},ia={key:0,class:"relative flex flex-1 justify-between text-[#999999]"},aa={class:"icon-wrap flex cursor-pointer items-center text-lg text-black"},la={class:"flex flex-1 flex-row-reverse"},oa={class:"ms-5 h-8 leading-8"},ra={class:"flex flex-col px-4 py-2"},ca={class:"flex h-8 items-center justify-between"},ua={class:"flex flex-1 overflow-hidden"},da={class:"flex-1 overflow-hidden truncate"},fa={class:"flex h-8 items-center justify-between"},pa={class:"flex flex-1 overflow-hidden"},ma={class:"flex-1 overflow-hidden truncate"},ha={class:"pop ms-5 leading-8"},va={class:"flex h-8 min-w-20 items-center justify-center"},ga=["title"],ya={key:1,class:"file-wrap overflow-hidden"},ba={class:"file-name line-clamp-1 break-all leading-5 text-black"},xa=["contenteditable"],wa={key:1,class:"file-text text-base font-medium"},Sa={class:"file-upload-time text-sm text-fontColor"},ka=["data-active","data-pid"],_a=["onClick"],Ta={key:0,class:"edit-icon iconfont icon-bianji me-1"},Ia=["title"],Ca=["onClick"],Pa={class:"speaker-actions flex items-center"},za={key:0,class:"iconfont icon-duihao me-2 text-xs !text-mainColor-900"},$a=["onClick"],Ea={class:"mt-3 border-b border-solid border-borderColor pb-2.5 ps-5"},Ra={key:0,class:"flex h-11 items-center overflow-hidden border-b border-solid border-borderColor ps-5"},Va=["title"],Ma={class:"dialog-footer flex justify-end py-3 pe-4"},Aa={class:"h-5 text-sm font-normal text-fontColor"},Oa=["data-pid"],La=["data-content-index","data-cid","data-sent-index","data-pid","onClick","contenteditable","onInput","onFocus"],Da={key:0,class:"half-wrap absolute bottom-0 left-0 h-[5.25rem] w-full"},Fa={class:"leading-5 text-black rtl:text-right"},Na={class:"mb-[1.5rem] text-base font-medium leading-[1.375rem] rtl:text-right"},Ba={class:"flex h-full w-full items-center"},ja={key:1,class:"flex w-full justify-center"},Ua=["title"],Wa={class:"dialog-footer"},Ha={class:"content-wrap"},qa={class:"mb-[0.625rem] leading-5 text-black"},Xa=["title"],Ka={class:"dialog-footer flex items-center justify-center"},Ya=Object.assign({name:"TranscriptDetail"},{__name:"index.client",props:{speakers:{type:Array,default:()=>[]},fileBaseInfo:{type:Object,default:()=>({})},transcriptInfo:{type:Object,default:()=>({})},otherLangTranscript:{type:Object,default:()=>({})},isShare:{type:Boolean,default:!1},shareName:{type:String,default:""}},emits:["translate","saveConfig","updateSpeakers"],setup(e,{expose:t,emit:s}){const l=e,o=s;ms({meta:()=>[{name:"viewport",content:"width=device-width, initial-scale=1.0, viewport-fit=cover"}]});const{isFreeUser:p}=hs(vs()),{getTime:v}=Vs(),{t:i,locale:m,getLocaleMessage:z}=ft(),x=hn();let{transcriptInfo:L,speakers:T}=Ze(l);const{getParagraphText:D}=Ri(),{container:q,isDragging:K,isDesktop:g,dragEnabled:j,isShowVideo:J,langId:$,displayVideo:S,gridStyle:ie,enableDrag:le,disableDrag:oe,handleDragStart:ee,handelToggleVideo:ne,handleBack:F,leftPanel:W,resizer:V,rightPanel:O,leftPanelStyle:Z,resizerStyle:he,rightPanelStyle:k,handleJumpUpgrade:X}=Oi(l),{playerAudio:Q,playerVideo:G,dynamicScroller:B,allSegments:re,initPlayers:d,updateOverlappingSegments:a,handleWordClick:u,isWordActive:r,setupI18nWatch:y,isVideo:h,updateSubtitle:w,isRtl:C}=Ai(L,J,l),{isEditRightTranscript:R,canUndo:Y,canRedo:be,handleEditRightTranscript:de,handleSaveRightTranscript:ve,handleContentEdit:Se,setActiveEditElement:He,isActiveEditElement:mt,resetActiveEditElement:A,undoOperation:P,redoOperation:E,handleDocumentClick:te,handleKeyDown:me,handleEnterEdit:ce,filterEnterStr:ke}=Li(L,B,u,Ei,w,o,l),{fileName:Xe,fileUploadTime:Lt,isEditing:ze,fileNameElement:Dt,isShowTimestamp:Ne,startEditing:Qe,saveFileName:et,cancelEditing:Me,handleShowTimestamp:Pn,formatSecondsFromMs:zn}=Fi(l),{editSpeakerDialogVisible:tt,selectedSpeakerId:ht,editingSpeakerId:Ft,editingSpeakerName:vt,applyToAllMatching:gt,speakerPopoverRef:$n,speakerPopoverVisible:Nt,selectedPid:En,speakerBtnRef:Bt,isShowSpeaker:$e,uniqueSpeakers:Rn,hasDuplicateSpeakers:Vn,handleSpeakerPopoverShow:Mn,confirmSpeakerSelection:An,openEditSpeakerDialog:jt,selectSpeaker:On,confirmEditSpeaker:Ln,handleShowSpeaker:Dn,handleOutsideClick:Fn,scrollbarRef:Nn}=Di(L,T,o,l),{langChooseV1Ref:Ut,langChoosePopoverRef:Wt,handleTranslateLangChoose:Ht,handleLangPopShow:qt,upgradeTipRef:Bn,upgradeVisibleHeight:yt,handleScrollEnd:jn}=Ni(o);y(m,z);const Un=pe(()=>{var fe;return $.value?(fe=vn[$.value])==null?void 0:fe.langCode:""});Ue([$,$e,Ne],()=>{o("saveConfig")});const Xt=gn(),Ke=b(!1),nt=b(""),Kt=()=>{var Ee,xe,ue,Ye;const fe=(xe=(Ee=Xt.userInfo)==null?void 0:Ee.userInfoVO)==null?void 0:xe.email,c=(Ye=(ue=Xt.userInfo)==null?void 0:ue.userInfoVO)==null?void 0:Ye.userid,Pe=x.query.taskId;nt.value=window.location.origin+x.path+`?shareId=${encodeURIComponent(c)}&shareName=${encodeURIComponent(fe)}&taskId=${Pe}`,Ke.value=!0},{copy:bt,copied:xt}=gs({legacy:!0}),Wn=async()=>{await bt(nt.value),xt.value?Le({message:i("TranscriptionPage.copySuccessful"),type:"success",plain:!0,appendTo:".share-dialog-i1mbjq1KV"}):Le({message:i("TranscriptionPage.copyFail"),type:"warning",plain:!0,appendTo:".share-dialog-i1mbjq1KV"}),setTimeout(()=>{Ke.value=!1},1e3)},Hn=async()=>{let fe="";L.value.paragraphs.forEach(c=>{fe+=D(c)}),await bt(fe),xt.value?Le({message:i("TranscriptionPage.copySuccessful"),type:"success",plain:!0,appendTo:".share-dialog-i1mbjq1KV"}):Le({message:i("TranscriptionPage.copyFail"),type:"warning",plain:!0,appendTo:".share-dialog-i1mbjq1KV"})},qn=async()=>{let fe="";L.value.paragraphs.forEach(c=>{c.translateContent!==void 0&&(fe+=c.translateContent)}),await bt(fe),xt.value?Le({message:i("TranscriptionPage.copySuccessful"),type:"success",plain:!0,appendTo:".share-dialog-i1mbjq1KV"}):Le({message:i("TranscriptionPage.copyFail"),type:"warning",plain:!0,appendTo:".share-dialog-i1mbjq1KV"})},st=b(!1),it=()=>{st.value=!0},Xn=()=>{var c,Pe,Ee,xe;let fe=null;return h.value?fe=G:fe=Q,{lastPlayTime:(c=fe.value)==null?void 0:c.currentTime.toFixed(3),lastPlayRate:(Pe=fe.value)==null?void 0:Pe.playbackRate,lastPlayVolume:(Ee=fe.value)!=null&&Ee.muted?0:(xe=fe.value)==null?void 0:xe.volume,isShowTimestamp:Ne.value,translateLang:$.value,isShowVideo:J.value,isShowSpeaker:$e.value}},wt=b([]),Yt=async()=>{const{transcriptApi:fe}=await je(async()=>{const{transcriptApi:Pe}=await import("./86auEJMD.js");return{transcriptApi:Pe}},__vite__mapDeps([0,1,2,3]),import.meta.url),c=await fe.getRecentLang();wt.value=c.text.map(Pe=>{const[Ee,xe]=Pe.split("#");return xe!=="null"?xe:Ps[Ee]}).filter(Boolean)};return ys(()=>{var fe,c;(fe=document==null?void 0:document.body)==null||fe.setAttribute("dir",C.value?"rtl":"ltr"),(c=document==null?void 0:document.documentElement)==null||c.setAttribute("dir",C.value?"rtl":"ltr")}),Mt(async()=>{await Be(),document.addEventListener("click",te),a(),d(l.fileBaseInfo,m,re),l.isShare||Yt()}),Vt(()=>{document.removeEventListener("click",te),G.value=null,Q.value=null}),t({getFileConfig:Xn,getRecentLang:Yt}),(fe,c)=>{const Pe=Rs,Ee=Ms,xe=bs,ue=xs,Ye=Ss,at=ws,St=ks,Kn=Ts,Yn=As,Gn=Is,Gt=Cs,Jn=Os;return I(),M("div",Bi,[f("div",ji,[!e.isShare&&n(p)?(I(),Ce(Pe,{key:0})):ae("",!0),e.isShare?(I(),Ce(Ee,{key:1})):ae("",!0)]),f("div",Ui,[n(g)?(I(),M("div",Wi,[f("div",Hi,[e.isShare?ae("",!0):(I(),M("div",qi,[U(xe,{onClick:n(F)},{default:N(()=>[U(n(Zt))]),_:1},8,["onClick"])])),f("div",Xi,[f("div",Ki,[e.isShare?(I(),M("span",Gi,H(n(Xe)),1)):(I(),M("span",{key:0,ref_key:"fileNameElement",ref:Dt,class:se(["file-text text-base font-medium",{editing:n(ze),"hover-effect":!n(ze),"inline-block":n(ze)}]),contenteditable:n(ze),title:n(ze)?void 0:n(Xe),onClick:c[0]||(c[0]=(..._)=>n(Qe)&&n(Qe)(..._)),onKeydown:[c[1]||(c[1]=Ge(Oe((..._)=>n(et)&&n(et)(..._),["prevent"]),["enter"])),c[2]||(c[2]=Ge((..._)=>n(Me)&&n(Me)(..._),["esc"]))],onBlur:c[3]||(c[3]=(..._)=>n(Me)&&n(Me)(..._))},H(n(Xe)),43,Yi))]),f("div",Ji,H(n(v)(n(Lt))),1)])]),f("div",Zi,[e.isShare?(I(),M(Ie,{key:1},[f("div",na,' "'+H(e.shareName)+'" '+H(n(i)("TranscriptionPage.shared")),1),U(ue,{text:"",class:"ms-2 h-8",onClick:it},{default:N(()=>[c[38]||(c[38]=f("span",{class:"iconfont icon-xiazai me-2 text-xs"},null,-1)),ge(" "+H(n(i)("TranscriptionPage.export")),1)]),_:1,__:[38]})],64)):(I(),M(Ie,{key:0},[U(lt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"transform opacity-0","enter-to-class":"transform opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"transform opacity-100","leave-to-class":"transform opacity-0"},{default:N(()=>[n(R)?(I(),M("div",Qi,[U(ue,{text:"",title:n(i)("TranscriptionPage.undo"),class:"!ms-[1.625rem] h-8 !bg-transparent !p-0",disabled:!n(Y),onClick:n(P)},{default:N(()=>c[29]||(c[29]=[f("span",{class:"iconfont icon-zuochexiao text-xs"},null,-1)])),_:1,__:[29]},8,["title","disabled","onClick"]),U(ue,{text:"",title:n(i)("TranscriptionPage.redo"),class:"!ms-[1.625rem] h-8 !bg-transparent !p-0",disabled:!n(be),onClick:n(E)},{default:N(()=>c[30]||(c[30]=[f("span",{class:"iconfont icon-youchexiao text-xs"},null,-1)])),_:1,__:[30]},8,["title","disabled","onClick"]),U(ue,{text:"",class:"h-8",onClick:n(ve)},{default:N(()=>[c[31]||(c[31]=f("span",{class:"iconfont icon-baocun1 me-2 text-xs"},null,-1)),ge(" "+H(n(i)("TranscriptionPage.save")),1)]),_:1,__:[31]},8,["onClick"])])):ae("",!0)]),_:1}),U(lt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"transform  opacity-0","enter-to-class":"transform opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"transform opacity-100","leave-to-class":"transform opacity-0"},{default:N(()=>[n(R)?ae("",!0):(I(),M("div",ea,[U(ue,{text:"",class:"h-8",disabled:n($)!=="",onClick:n(de)},{default:N(()=>[c[32]||(c[32]=f("span",{class:"iconfont icon-bianji me-2 text-xs"},null,-1)),ge(" "+H(n(i)("TranscriptionPage.edit")),1)]),_:1,__:[32]},8,["disabled","onClick"]),U(at,{ref_key:"langChoosePopoverRef",ref:Wt,placement:"bottom",width:"50rem",trigger:"click","show-arrow":!1,"popper-style":"padding:0;",onShow:n(qt)},{reference:N(()=>[U(ue,{text:""},{default:N(()=>[c[33]||(c[33]=f("span",{class:"iconfont icon-fanyi me-2 text-xs"},null,-1)),f("div",ta,H(n($)?n(i)("TranscriptionPage.langChooseV1."+n($)):n(i)("TranscriptionPage.translate")),1),U(xe,{class:"el-icon--right !ms-2"},{default:N(()=>[U(n(Qt))]),_:1})]),_:1,__:[33]})]),default:N(()=>[U(Ye,{ref_key:"langChooseV1Ref",ref:Ut,modelValue:n($),"onUpdate:modelValue":c[4]||(c[4]=_=>Ve($)?$.value=_:null),recentLanguageKeys:n(wt),onChoose:n(Ht)},null,8,["modelValue","recentLanguageKeys","onChoose"])]),_:1},8,["onShow"]),U(ue,{text:"",bg:n($e),class:"h-8",onClick:n(Dn)},{default:N(()=>[c[34]||(c[34]=f("span",{class:"iconfont icon-jiangyanzhe me-2 text-xs"},null,-1)),ge(" "+H(n(i)("TranscriptionPage.showSpeaker")),1)]),_:1,__:[34]},8,["bg","onClick"]),U(ue,{text:"",bg:n(Ne),class:"h-8",onClick:n(Pn)},{default:N(()=>[c[35]||(c[35]=f("span",{class:"iconfont icon-shijian me-2 text-xs"},null,-1)),ge(" "+H(n(i)("TranscriptionPage.showTimestamp")),1)]),_:1,__:[35]},8,["bg","onClick"]),U(ue,{text:"",class:"h-8",onClick:Kt},{default:N(()=>[c[36]||(c[36]=f("span",{class:"iconfont icon-fenxiang me-2 text-xs"},null,-1)),ge(" "+H(n(i)("TranscriptionPage.share")),1)]),_:1,__:[36]}),U(ue,{text:"",class:"h-8",onClick:it},{default:N(()=>[c[37]||(c[37]=f("span",{class:"iconfont icon-xiazai me-2 text-xs"},null,-1)),ge(" "+H(n(i)("TranscriptionPage.export")),1)]),_:1,__:[37]})]))]),_:1})],64))])])):(I(),M("div",{key:1,class:se(["relative flex h-12 w-full shrink-0 flex-row items-center overflow-hidden border-b border-solid border-borderColor px-4",{"flex-row-reverse":n(R),"justify-end":e.isShare}])},[e.isShare?(I(),M(Ie,{key:1},[f("div",va,H(e.shareName)+" "+H(n(i)("TranscriptionPage.shared")),1),U(ue,{text:"",class:"ms-2 h-8",onClick:it},{default:N(()=>[c[49]||(c[49]=f("span",{class:"iconfont icon-xiazai me-2 text-xs"},null,-1)),ge(" "+H(n(i)("TranscriptionPage.export")),1)]),_:1,__:[49]})],64)):(I(),M(Ie,{key:0},[U(lt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"transform opacity-0","enter-to-class":"transform opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"transform opacity-100","leave-to-class":"transform opacity-0"},{default:N(()=>[n(R)?(I(),M("div",sa,[U(ue,{text:"",title:n(i)("TranscriptionPage.undo"),class:"h-8 !bg-transparent !p-0",disabled:!n(Y),onClick:n(P)},{default:N(()=>c[39]||(c[39]=[f("span",{class:"iconfont icon-zuochexiao text-xs"},null,-1)])),_:1,__:[39]},8,["title","disabled","onClick"]),U(ue,{text:"",title:n(i)("TranscriptionPage.redo"),class:"!ms-[1.625rem] h-8 !bg-transparent !p-0",disabled:!n(be),onClick:n(E)},{default:N(()=>c[40]||(c[40]=[f("span",{class:"iconfont icon-youchexiao text-xs"},null,-1)])),_:1,__:[40]},8,["title","disabled","onClick"]),U(ue,{text:"",class:"h-8",onClick:n(ve)},{default:N(()=>c[41]||(c[41]=[f("span",{class:"iconfont icon-baocun1 me-2 text-xs"},null,-1)])),_:1,__:[41]},8,["onClick"])])):ae("",!0)]),_:1}),U(lt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"transform opacity-0","enter-to-class":"transform opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"transform opacity-100","leave-to-class":"transform opacity-0"},{default:N(()=>[n(R)?ae("",!0):(I(),M("div",ia,[f("div",aa,[U(xe,{onClick:n(F)},{default:N(()=>[U(n(Zt))]),_:1},8,["onClick"])]),f("div",la,[f("div",oa,[U(at,{placement:"bottom",width:"12rem",trigger:"click","popper-style":"padding:0; min-width:unset; border-radius: 0.5rem"},{reference:N(()=>c[42]||(c[42]=[f("span",{class:"iconfont icon-suolve me-2 inline-block rotate-90 text-xs"},null,-1)])),default:N(()=>[f("div",ra,[f("div",ca,[f("div",ua,[c[43]||(c[43]=f("span",{class:"iconfont icon-jiangyanzhe me-2 text-sm"},null,-1)),f("span",da,H(n(i)("TranscriptionPage.showSpeaker")),1)]),U(St,{modelValue:n($e),"onUpdate:modelValue":c[5]||(c[5]=_=>Ve($e)?$e.value=_:null),class:"self-center"},null,8,["modelValue"])]),f("div",fa,[f("div",pa,[c[44]||(c[44]=f("span",{class:"iconfont icon-shijian me-2 text-sm"},null,-1)),f("span",ma,H(n(i)("TranscriptionPage.showTimestamp")),1)]),U(St,{modelValue:n(Ne),"onUpdate:modelValue":c[6]||(c[6]=_=>Ve(Ne)?Ne.value=_:null)},null,8,["modelValue"])]),f("div",{class:"flex h-8 items-center",onClick:Kt},[c[45]||(c[45]=f("span",{class:"iconfont icon-fenxiang me-2 text-sm"},null,-1)),f("span",null,H(n(i)("TranscriptionPage.share")),1)])])]),_:1})]),f("div",{class:"ms-5 h-8 leading-8",onClick:it},c[46]||(c[46]=[f("span",{class:"iconfont icon-xiazai me-2 text-xs"},null,-1)])),U(at,{ref_key:"langChoosePopoverRef",ref:Wt,placement:"bottom",width:n(g)?"50rem":"23rem",trigger:"click","show-arrow":!1,"popper-style":"padding:0;",onShow:n(qt)},{reference:N(()=>[f("div",ha,[c[47]||(c[47]=f("span",{class:"iconfont icon-fanyi text-sm"},null,-1)),U(xe,{class:"el-icon--right !ms-0 !text-xs"},{default:N(()=>[U(n(Qt))]),_:1})])]),default:N(()=>[U(Ye,{ref_key:"langChooseV1Ref",ref:Ut,modelValue:n($),"onUpdate:modelValue":c[7]||(c[7]=_=>Ve($)?$.value=_:null),recentLanguageKeys:n(wt),onChoose:n(Ht)},null,8,["modelValue","recentLanguageKeys","onChoose"])]),_:1},8,["width","onShow"]),f("div",{class:se(["ms-5 h-8 leading-8",[n($)!==""?"pointer-events-none opacity-50":""]]),onClick:c[8]||(c[8]=(..._)=>n(de)&&n(de)(..._))},c[48]||(c[48]=[f("span",{class:"iconfont icon-bianji me-2 text-xs"},null,-1)]),2)])]))]),_:1})],64))],2)),f("div",{ref_key:"container",ref:q,class:se(["draggable-panels grid-container flex-1 overflow-hidden rounded-xl bg-white px-4 py-[1.125rem]",[n(S)?"":"!py-0"]]),style:we(n(ie))},[De(f("div",{ref_key:"leftPanel",ref:W,style:we(n(Z)),class:"flex bg-white"},c[50]||(c[50]=[f("div",{id:"mse",class:"tm-xg-video rounded-lg"},null,-1)]),4),[[qe,n(S)&&n(h)]]),De(f("div",{ref_key:"resizer",ref:V,style:we(n(he)),class:se(["drag-handle z-10 mx-2 bg-mainColor-600",{dragging:n(K),"drag-disabled":!n(j)}]),onMousedown:c[9]||(c[9]=(..._)=>n(ee)&&n(ee)(..._)),onMouseenter:c[10]||(c[10]=(..._)=>n(le)&&n(le)(..._)),onMouseleave:c[11]||(c[11]=(..._)=>n(oe)&&n(oe)(..._))},null,38),[[qe,n(S)&&n(h)]]),f("div",{ref_key:"rightPanel",ref:O,class:se(["relative flex overflow-hidden px-4",[n(S)?"":"pe-10 ps-4 pt-4",n($)?"show-lang-box":"",n($e)?"show-speaker-box":"",n(g)?"":"is-mobile flex-col !px-0",n(yt)?"upgrade-visible":"",!n($)&&!n(S)?"mx-auto max-w-[92rem] !pe-0 !ps-0":""]]),style:we({...n(k),"--upgrade-visible-height":n(yt)?+n(yt)+1.5+"rem":0}),id:"right-btn"},[n($)?(I(),M("span",{key:0,class:se(["iconfont icon-shanchu cursor-pointer text-xs",[n(g)?"absolute top-4":"flex h-[1.75rem] w-full justify-end",n(C)?"left-4":"right-4"]]),title:n(i)("TranscriptionPage.closeTrans"),onClick:c[12]||(c[12]=_=>$.value="")},null,10,ga)):ae("",!0),n(g)?ae("",!0):(I(),M("div",ya,[f("div",ba,[e.isShare?(I(),M("span",wa,H(n(Xe)),1)):(I(),M("div",{key:0,ref_key:"fileNameElement",ref:Dt,class:se(["file-text text-base font-medium",{editing:n(ze),"hover-effect":!n(ze)&&n(g),"inline-block":n(ze)}]),contenteditable:n(ze),onClick:c[13]||(c[13]=(..._)=>n(Qe)&&n(Qe)(..._)),onKeydown:[c[14]||(c[14]=Ge(Oe((..._)=>n(et)&&n(et)(..._),["prevent"]),["enter"])),c[15]||(c[15]=Ge((..._)=>n(Me)&&n(Me)(..._),["esc"]))],onBlur:c[16]||(c[16]=(..._)=>n(Me)&&n(Me)(..._))},H(n(Xe)),43,xa))]),f("div",Sa,H(n(v)(n(Lt))),1)])),n(L)?(I(),Ce(n(Ot),{key:2,ref_key:"dynamicScroller",ref:B,items:n(L).paragraphs,"min-item-size":56,keyField:"pid",skipHover:"",class:"transcript-container flex flex-1 overflow-y-auto",onScrollEnd:n(jn)},{default:N(({item:_,index:Zn,active:kt})=>[U(n(Cn),{item:_,active:kt,"size-dependencies":[_.sentences],"data-index":Zn,"data-active":kt,class:"dy-item"},{default:N(()=>[(I(),M("div",{key:_.pid,"data-active":kt,"data-pid":_.pid,class:se(["virtual-item-wrap relative flex bg-white",[n(g)?"flex-row pb-4":"flex-col"]])},[De(f("div",{class:se(["left-speaker flex-shrink-0",[n(g)?"w-[6rem] pt-4":"my-2.5 flex flex-1"]])},[De((I(),M("div",{ref_key:"speakerBtnRef",ref:Bt,class:se([{"is-shared":e.isShare,"hover:bg-[#FAFAFA]":!e.isShare&&n(g),"w-28 px-3.5 py-2":n(g),"inline-block max-w-72 overflow-hidden":!n(g),"cursor-pointer":!e.isShare},"speaker-container inline-flex items-center rounded-[1.375rem] transition-colors"]),onClick:ye=>n(Mn)(_.speakerId,_.pid,e.isShare)},[n(g)?(I(),M("span",Ta)):ae("",!0),f("span",{class:"truncate text-base font-medium text-fontColor",title:_.speaker},H(_.speaker),9,Ia)],10,_a)),[[n(_s),n(Fn)]]),n(Nt)&&n(En)===_.pid?(I(),Ce(at,{key:0,ref_key:"speakerPopoverRef",ref:$n,placement:"bottom",visible:n(Nt),"virtual-ref":n(Bt),"virtual-triggering":"",width:"18rem","popper-class":"pop-iAHFsY2 !p-0"},{default:N(()=>[U(Kn,{"max-height":"14rem",class:"pt-2",ref_key:"scrollbarRef",ref:Nn},{default:N(()=>[(I(!0),M(Ie,null,Je(n(Rn),(ye,_e)=>(I(),M("div",{key:_e,class:se(["speaker-item flex h-8 cursor-pointer items-center justify-between px-5",{"is-active text-[#F5F7FA]":n(ht)===ye.id,"hover:bg-[#EFF4FF]":!0}])},[f("div",{class:"flex flex-1 items-center overflow-hidden",onClick:Re=>n(On)(ye.id)},[c[51]||(c[51]=f("span",{class:"iconfont icon-jiangyanzhe me-2 flex-shrink-0 text-sm text-fontColor"},null,-1)),f("span",{class:se(["inline-block truncate text-black",{"!text-mainColor-900":n(ht)===ye.id}])},H(ye.name),3)],8,Ca),f("div",Pa,[n(ht)===ye.id?(I(),M("span",za)):ae("",!0),f("span",{class:"iconfont icon-bianji edit-speaker-icon text-xs opacity-0",onClick:Oe(Re=>n(jt)(ye),["stop"])},null,8,$a)])],2))),128))]),_:2},1536),f("div",Ea,[U(ue,{plain:"",class:"!rounded-lg !border-borderColor !px-3 !text-black",onClick:c[17]||(c[17]=ye=>n(jt)())},{default:N(()=>[f("span",null," + "+H(n(i)("TranscriptionPage.addNew")),1)]),_:1})]),n(Vn)?(I(),M("div",Ra,[U(St,{modelValue:n(gt),"onUpdate:modelValue":c[18]||(c[18]=ye=>Ve(gt)?gt.value=ye:null),"true-value":1,"false-value":0,class:"overflow-hidden"},{default:N(()=>[f("div",{title:n(i)("TranscriptionPage.applyToAllMatchingSpeakers"),class:"overflow-hidden truncate !pl-0 ps-2 text-black"},H(n(i)("TranscriptionPage.applyToAllMatchingSpeakers")),9,Va)]),_:1},8,["modelValue"])])):ae("",!0),f("div",Ma,[U(ue,{plain:"",class:"!rounded-lg !border-borderColor !px-4 !text-black",onClick:n(An)},{default:N(()=>[ge(H(n(i)("TranscriptionPage.confirm")),1)]),_:1},8,["onClick"])])]),_:2},1032,["visible","virtual-ref"])):ae("",!0)],2),[[qe,n($e)]]),f("div",{class:se(["right-content transcript-content-wrap flex flex-1 flex-col",[n(g)?n($e)?"ms-[1.5rem]":"ms-[0.625rem]":""]])},[f("div",Aa,[De(f("span",null,H(n(zn)(_.start_time)),513),[[qe,n(Ne)]])]),f("div",{class:se(["grid w-full flex-1",[n(g)&&n($)?"grid-cols-2":"grid-cols-1"]])},[n(g)||!n(g)&&!n($)?(I(),M("div",{key:0,"data-pid":_.pid,class:se(["content-span-parent-node whitespace-normal break-words break-all text-lg tracking-[0.35px]",[n(g)?"pe-4":"",n(R)?"outline-none":""]])},[(I(!0),M(Ie,null,Je(_.sentences,(ye,_e)=>(I(),M(Ie,{key:`${_.pid}-sent-${_e}`},[(I(!0),M(Ie,null,Je(ye.contents,(Re,Ae)=>(I(),M("span",{key:`${_.pid}-${_e}-${Ae}`,"data-content-index":Ae,"data-cid":Re.cid,"data-sent-index":_e,"data-pid":_.pid,onKeydown:[c[19]||(c[19]=Te=>n(me)(Te)),c[21]||(c[21]=Ge(Oe((...Te)=>n(ce)&&n(ce)(...Te),["prevent"]),["enter"]))],onClick:Oe(Te=>n(R)?n(He)(_.pid,_e,Ae,Re,Te):n(u)(_.pid,_e,Ae,Re),["self"]),contenteditable:n(R),onInput:Te=>n(Se)(Te,_.pid,_e,Ae,Re),onFocus:Oe(Te=>n(He)(_.pid,_e,Ae,Re,Te),["self"]),onBlur:c[20]||(c[20]=(...Te)=>n(A)&&n(A)(...Te)),class:se(["cursor-pointer whitespace-pre-wrap break-words break-all border-b border-solid border-transparent py-1 text-lg !leading-[2.125rem] tracking-[0.35px] outline-none transition-colors",n(R)&&n(mt)(_.pid,_e,Ae)?"content-editable !rounded-none !text-black":"",n(R)?"!cursor-text":n(r)(Re,_.pid,_e,Ae)?"rounded-md bg-mainColor-900 text-white":"md:rounded-md md:hover:bg-mainColor-900 md:hover:text-white"])},H(n(ke)(Re.content)),43,La))),128))],64))),128))],10,Oa)):ae("",!0),n($)&&!e.isShare?(I(),M("div",{key:1,class:se([[n(g)?"":"!px-0"],"other-lange-wrap whitespace-normal break-words px-16 text-lg !leading-8"])},[f("span",null,H(_.translateContent),1)],2)):ae("",!0)],2)],2),!e.isShare&&_.isLast&&e.fileBaseInfo.isHalfHour&&!n(R)?(I(),M("div",Da)):ae("",!0)],10,ka)),!e.isShare&&_.isLast&&e.fileBaseInfo.isHalfHour?(I(),M("div",{key:0,ref_key:"upgradeTipRef",ref:Bn,class:se([[n(S)&&n(h)?"!w-full":""],"mx-auto flex w-full flex-col items-center justify-center rounded-lg bg-[#DFEAFF] p-[2.25rem] md:w-1/2"])},[f("div",Fa,H(n(i)("TranscriptionPage.upgradeTip30")),1),f("div",Na,H(n(i)("TranscriptionPage.upgradeTipMore")),1),f("div",{onClick:c[22]||(c[22]=(...ye)=>n(X)&&n(X)(...ye)),class:"mt-2 flex h-[2rem] flex-shrink-0 cursor-pointer items-center justify-center rounded-[2rem] bg-mainColor-900 px-7 text-sm font-medium text-white duration-75 ease-linear hover:bg-opacity-80 hover:text-opacity-80 sm:mt-0"},[U(Yn,{class:"me-2 h-7 w-7",src:"/assets/images/home/rocket.svg"}),ge(" "+H(n(i)("TranscriptionPage.upgradeBtn")),1)])],2)):ae("",!0)]),_:2},1032,["item","active","size-dependencies","data-index","data-active"])]),_:1},8,["items","onScrollEnd"])):ae("",!0)],6)],6),f("div",{class:se(["audio-container sticky bottom-0 flex w-full items-center justify-center",[n(g)?"h-[4.5rem]":"h-[3.5rem]"]])},[f("div",{class:se(["audio-wrap relative flex h-full w-full items-center md:px-4",[n(g)?"border-t border-solid border-borderColor":""]])},[c[52]||(c[52]=f("div",{id:"audioID",class:"hidden"},null,-1)),f("div",Ba,[n(h)?(I(),M("div",ja,[n(G)?(I(),Ce(xn,{key:0,player:n(G)},null,8,["player"])):ae("",!0)])):(I(),M("div",{key:0,id:"audio-crt",class:se(["xgplayer xgplayer-tm flex justify-center",{"is-mobile":!n(g)}])},null,2)),n(g)&&n(h)?(I(),M("div",{key:2,class:se([[n($)?"cursor-not-allowed opacity-50":""],"mt-0.5 flex !h-9 !w-9 items-center justify-center rounded-lg hover:bg-[#D3D3D3]"])},[f("span",{title:n(J)?n(i)("TranscriptionPage.hideVideo"):n(i)("TranscriptionPage.showVideo"),class:se(["iconfont cursor-pointer text-[1.375rem]",[n(J)?"icon-shipinbofang":"icon-guanbishipin",n($)?"pointer-events-none":""]]),onClick:c[23]||(c[23]=(..._)=>n(ne)&&n(ne)(..._))},null,10,Ua)],2)):ae("",!0)])],2)],2)]),U(Gt,{modelValue:n(tt),"onUpdate:modelValue":c[26]||(c[26]=_=>Ve(tt)?tt.value=_:null),title:[void 0,null,""].includes(n(Ft))?n(i)("TranscriptionPage.createANewSpeaker"):n(i)("TranscriptionPage.edit"),width:"22rem","header-class":"edit-speaker-header-class","body-class":"edit-speaker-body-class","footer-class":"edit-speaker-footer-class","align-center":"","show-close":!0,"append-to-body":"","close-on-click-modal":!1,class:"edit-speaker-dialog common-dialog-S5NaD2"},{footer:N(()=>[f("div",Wa,[U(ue,{class:"!rounded-lg !border-borderColor !px-4 !text-black",onClick:c[25]||(c[25]=_=>tt.value=!1)},{default:N(()=>[ge(H(n(i)("TranscriptionPage.cancel")),1)]),_:1}),U(ue,{type:"primary",class:"!rounded-lg !px-4",onClick:n(Ln)},{default:N(()=>[ge(H([void 0,null,""].includes(n(Ft))?n(i)("TranscriptionPage.addSpeaker"):n(i)("TranscriptionPage.confirm")),1)]),_:1},8,["onClick"])])]),default:N(()=>[U(Gn,{modelValue:n(vt),"onUpdate:modelValue":c[24]||(c[24]=_=>Ve(vt)?vt.value=_:null),placeholder:n(i)("TranscriptionPage.speakerName")},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue","title"]),U(Gt,{modelValue:n(Ke),"onUpdate:modelValue":c[27]||(c[27]=_=>Ve(Ke)?Ke.value=_:null),title:n(i)("TranscriptionPage.share"),width:n(g)?"29rem":"23rem","align-center":"","show-close":!0,"append-to-body":"","close-on-click-modal":!1,class:"share-dialog-i1mbjq1KV common-dialog-S5NaD2"},{footer:N(()=>[f("div",Ka,[U(ue,{type:"primary",class:"w-[17.5rem]",onClick:Wn},{default:N(()=>[ge(H(n(i)("TranscriptionPage.copyLink")),1)]),_:1})])]),default:N(()=>[f("div",Ha,[f("div",qa,H(n(i)("TranscriptionPage.shareTips")),1),f("div",{title:n(nt),class:"h-[2.125rem] w-full truncate rounded-lg border border-borderColor bg-boxBgColor px-4 leading-[2.125rem]"},H(n(nt)),9,Xa),c[55]||(c[55]=f("br",null,null,-1)),U(ue,{type:"primary",onClick:Hn},{default:N(()=>c[53]||(c[53]=[ge("复制原文")])),_:1,__:[53]}),U(ue,{type:"primary",onClick:qn},{default:N(()=>c[54]||(c[54]=[ge("复制译文")])),_:1,__:[54]})])]),_:1},8,["modelValue","title","width"]),U(Jn,{taskId:e.fileBaseInfo.taskId,translateLang:n(Un),fileId:e.fileBaseInfo.fileId,modelValue:n(st),"onUpdate:modelValue":c[28]||(c[28]=_=>Ve(st)?st.value=_:null)},null,8,["taskId","translateLang","fileId","modelValue"])])}}}),Ga=cn(Ya,[["__scopeId","data-v-851a1da6"]]),Ja=Es(Ga),Za={key:1,class:"del-box flex h-screen w-full flex-col items-center justify-center"},Qa={class:"title text-[1.25rem] font-medium leading-7 text-black"},el={class:"desc leading-5 text-black"},ul=Object.assign({name:"TranscriptIndex"},{__name:"[id]",setup(e){const s=mn()("/user/login"),{t:l}=ft(),o=hn(),p=gn(),v=o.params.id,i=o.query.taskId,m=o.query.shareId||"",z=decodeURIComponent(o.query.shareName||""),x=!!m;let L=null;const T=b(!1),D=b([]),q=b(null),K=async W=>{L=an.service({fullscreen:!0});try{const{transcriptApi:V}=await je(async()=>{const{transcriptApi:O}=await import("./86auEJMD.js");return{transcriptApi:O}},__vite__mapDeps([0,1,2,3]),import.meta.url);return x?await V.getTranscriptInfoWithoutToken(W,i,decodeURIComponent(m)):await V.getTranscriptInfo(W,i)}catch(V){if(console.error("获取转录内容失败",V),V.code===610006)return en(s)}finally{L.close()}},g=async(W,V,O,Z,he)=>{L=an.service({fullscreen:!0});try{const{transcriptApi:k}=await je(async()=>{const{transcriptApi:X}=await import("./86auEJMD.js");return{transcriptApi:X}},__vite__mapDeps([0,1,2,3]),import.meta.url);return await k.getOtherLangOfTranscript({fileId:W,taskId:V,targetLang:O,langName:Z,originLang:he})}catch(k){Le({message:k.message,type:"warning",plain:!0}),console.error("获取其他语言翻译内容失败:",k)}finally{L.close()}},j={lastPlayTime:0,lastPlayRate:1,lastPlayVolume:.6,isShowTimestamp:!0,translateLang:"",isShowVideo:!0,isShowSpeaker:!0},J=b(""),$=b({}),S=b(null),ie=b(null),le=async(W,V=!1)=>{var Z;if(console.log("🚀 ~ file: [id].vue method: translate line: 110 🚀",W),!W.langCode)return;let O=await g(v,i,W.langCode,W.langId||W.lang,J.value);O==null||O.forEach(he=>{const k=S.value.paragraphs[$.value[he.pid]];k.translateContent=he.translateContent}),V||(Z=ie==null?void 0:ie.value)==null||Z.getRecentLang()},oe=async W=>{try{const{transcriptApi:V}=await je(async()=>{const{transcriptApi:O}=await import("./86auEJMD.js");return{transcriptApi:O}},__vite__mapDeps([0,1,2,3]),import.meta.url);await V.saveFileConfig({fileId:v,taskId:i,options:JSON.stringify(W)})}catch(V){console.error("fail:",V)}},ee=()=>{if(!ie.value||x)return;const W=ie.value.getFileConfig();oe(W)},ne=pe(()=>!x&&!p.userInfo),F=W=>{D.value=W};return Mt(async()=>{if(!v||!i)return Le({message:"fail",type:"warning",plain:!0});if(ne.value)return en(s);let{fileMetaInfo:W,transcribeParagraphs:V,speaker:O,options:Z,language:he,gmtCreateTime:k,duration:X,isHalfHour:Q}=await K(v);if(T.value=W.deleted!==0,J.value=he,O??(O=[]),Z??(Z=j),D.value=O.map(({speaker_id:G,speaker:B,count:re})=>({id:G,name:B,count:re})).sort((G,B)=>G.id-B.id),Z&&Object.keys(Z).length>0?Z=Object.assign({},j,Z):Z=j,x&&(Z=Object.assign(Z,{lastPlayTime:0,lastPlayRate:1,lastPlayVolume:.6,translateLang:""})),W.gmtCreateTime=k,q.value={...Z,...W,taskId:i,fileId:v,duration:X,isHalfHour:Q},$.value=V.reduce((G,B,re)=>(G[B.pid]=re,re===V.length-1&&(B.isLast=!0),G),{}),S.value={paragraphs:V},Z.translateLang){const G=vn[Z.translateLang];G&&le(G,!0)}window.addEventListener("beforeunload",ee)}),Vt(()=>{window.removeEventListener("beforeunload",ee)}),zs((W,V,O)=>{ee(),O()}),(W,V)=>{const O=Ja,Z=$s;return I(),Ce(Z,null,{default:N(()=>[n(S)&&!n(T)?(I(),Ce(O,{key:0,ref_key:"tsDRef",ref:ie,speakers:n(D),fileBaseInfo:n(q),transcriptInfo:n(S),isShare:x,shareName:n(z),onTranslate:le,onSaveConfig:ee,onUpdateSpeakers:F},null,8,["speakers","fileBaseInfo","transcriptInfo","shareName"])):ae("",!0),n(T)?(I(),M("div",Za,[f("div",Qa,H(n(l)("TranscriptionPage.notFund")),1),f("div",el,H(n(l)("TranscriptionPage.notFundDesc")),1)])):ae("",!0)]),_:1})}}});export{ul as default};
