const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C1ybjr4I.js","./B_OshFF3.js","./DjTJqZtn.js","./entry.DofVldok.css"])))=>i.map(i=>d[i]);
import{d as pe,x as me,k as j,z as y,A as c,C as _,ap as fe,E as t,Z as ve,D as m,B as o,G as n,$ as ee,F as z,_ as te,M as _e,r,I as he,aa as we,a8 as xe,ab as ge,o as ye,aA as be,V as H,y as Ce,e as Ie,P as $,a2 as L,Q as C,a1 as Pe,a0 as Ve,W as ke,a3 as Q,a4 as Y,a5 as J,a6 as K,a7 as X}from"./DjTJqZtn.js";import{_ as Se}from"./DbrphaLi.js";import{u as Ee}from"./CPyf-64M.js";const Te={class:"customer-dialog"},$e={class:"flex h-[7rem] w-full items-center justify-center"},Ue={class:"flex justify-center"},Ae=pe({__name:"resetSuc",props:{modelValue:{type:Boolean}},emits:["update:modelValue","confirm"],setup(U,{emit:O}){const{t:I}=me(),l=U,x=O,h=j({get:()=>l.modelValue,set:u=>x("update:modelValue",u)}),A=async()=>{x("confirm")},P=u=>{u(),setTimeout(()=>{A()},300)};return(u,V)=>{const i=ee,f=fe;return c(),y("div",Te,[_(f,{"before-close":P,modelValue:t(h),"onUpdate:modelValue":V[0]||(V[0]=b=>ve(h)?h.value=b:null),title:t(I)("IdentityInfoManage.resetPassword")},{footer:m(()=>[o("div",Ue,[_(i,{onClick:A,type:"primary"},{default:m(()=>[z(n(t(I)("HomePage.tour.finish")),1)]),_:1})])]),default:m(()=>[o("div",$e,n(t(I)("IdentityInfoManage.passwordResetOk")),1)]),_:1},8,["modelValue","title"])])}}}),Be=te(Ae,[["__scopeId","data-v-69b8ea35"]]),De={class:"mb-10p flex flex-1 flex-col items-center justify-center"},Le={class:"flex flex-col items-center justify-center pt-[3.5rem]"},Re={class:"mb-[0.25rem] text-center text-[1.875rem] text-black"},Me={class:"mb-[1.5rem] text-[1rem]"},Fe={class:"flex w-full max-w-[20rem] flex-col items-center"},Ne={key:1,class:"text-[0.95rem] text-gray-400"},je={key:0,class:"self-start text-start text-xs text-subColor-normal"},ze={class:"mb-3 mt-2 text-xs text-fontColor"},Oe={key:1,class:"h-4"},We={key:2,class:"self-start text-start text-xs text-subColor-normal"},Ze={class:"mb-6 flex h-[2rem] w-full items-center"},qe={class:"me-4 text-xs"},Ge={class:"password-leve-wrap flex flex-1 items-center"},He={class:"password-leve-item"},Qe={class:"password-leve-msg"},Ye={class:"password-leve-item"},Je={class:"password-leve-msg"},Ke={class:"password-leve-item"},Xe={class:"password-leve-msg"},et={key:3,class:"h-4"},tt={class:"mb-[2rem] mt-1 h-[1rem] self-start text-start text-xs text-subColor-normal"},st={__name:"setPassword",props:{pageSource:{type:String,default:""},agreeTerm:{type:Boolean,default:!0}},emits:["change"],setup(U,{emit:O}){const I=_e(),l=Ee("IdentityInfoManage"),x=r(!1),h=r(!1),A=he(),P=U,u=P.pageSource||A.query.type||"set",V=we(),i=r(""),f=r(""),b=r(""),R=xe(),{signupEmail:k,sendCodeFlag:se,stroeCountdown:W}=ge(R),B=r(""),v=r(""),S=r(""),w=r(0);let M=null;ye(()=>{se.value?(R.setSendCodeFlag(!1),F()):W.value&&F(W.value,!1)});const F=async(e=60,s=!0)=>{if(k.value&&(i.value="",!(w.value>0)&&(w.value=e,M=be(()=>{w.value--,R.setCountdown(w.value),w.value<=0&&(clearInterval(M),M=null,i.value="")},1e3),!!s)))try{let a=0;u==="set"?a=0:u==="reset"&&(a=1);const{userApi:d}=await H(async()=>{const{userApi:T}=await import("./C1ybjr4I.js");return{userApi:T}},__vite__mapDeps([0,1,2,3]),import.meta.url);let g;P.pageSource==="reset"?g=await d.sendCaptcha({email:k.value,captchaType:a}):g=await d.sendCaptchaWithoutUser({email:k.value,captchaType:a})}catch(a){w.value=10,i.value=(a==null?void 0:a.message)||(a==null?void 0:a.code)}},N=j(()=>{const e=v.value||"";if(e.length<6)return 0;const s=/^[A-Z]+$/.test(e),a=/^[a-z]+$/.test(e),d=/^\d+$/.test(e),g=/^[!@#$%^&*()_\-+=\[\]{};:'",.<>/?\\|`~·！￥……（）——【】｛｝；：‘’“”，。《》、？｜~·]+$/.test(e);if(s||a||d||g||e.length>=6&&e.length<8)return 1;const T=/[A-Z]/.test(e),p=/[a-z]/.test(e),ce=/\d/.test(e),de=/[!@#$%^&*()_\-+=\[\]{};:'",.<>/?\\|`~·！￥……（）——【】｛｝；：‘’“”，。《》、？｜~·]/.test(e);return e.length>=8&&T&&p&&ce&&de?3:2}),ae=j(()=>B.value&&v.value&&S.value),D=r(!1),Z=Ce(),E=r(!1),oe=async()=>{if(i.value="",f.value="",b.value="",v.value.length<6){f.value=l("atLeastSix");return}if(v.value!==S.value){b.value=l("passwordNotMatch");return}if(!E.value)try{E.value=!0;const{userApi:e}=await H(async()=>{const{userApi:d}=await import("./C1ybjr4I.js");return{userApi:d}},__vite__mapDeps([0,1,2,3]),import.meta.url),s={email:k.value,password:v.value,captcha:B.value};let a;u==="set"?a=await e.sysSignupUser(s):u==="reset"&&(P.pageSource==="reset"?a=await e.resetPassword(s):a=await e.forgetPassword(s)),E.value=!1,I.setUserInfo(a),u==="set"?V.push({path:Z("/home")}):u==="reset"&&(D.value=!0)}catch(e){E.value=!1;const s=e.code;[14006,14007].includes(s)&&(i.value=e==null?void 0:e.message),[14008].includes(s)&&(f.value=e==null?void 0:e.message)}},le=()=>{D.value=!1,V.push({path:Z("/home")})};function ne(e){v.value=e.replace(/[\u4e00-\u9fa5]/g,""),v.value=e.replace(" ","")}function ue(e){S.value=e.replace(/[\u4e00-\u9fa5]/g,"")}const q=r(null);function re(){x.value=!x.value,X(()=>{var s;const e=(s=q.value)==null?void 0:s.input;e&&setTimeout(()=>{const a=e.value.length;e.setSelectionRange(a,a),e.focus()},0)})}const G=r(null);function ie(){h.value=!h.value,X(()=>{var s;const e=(s=G.value)==null?void 0:s.input;e&&setTimeout(()=>{const a=e.value.length;e.setSelectionRange(a,a),e.focus()},0)})}return Ie(()=>{}),(e,s)=>{const a=ee,d=Ve,g=ke,T=Se;return c(),y("div",De,[o("div",Le,[o("h1",Re,n(t(u)==="reset"?t(l)("resetYourPassword"):t(l)("setPassword")),1),o("span",Me,n(t(k)),1)]),o("div",Fe,[_(d,{modelValue:B.value,"onUpdate:modelValue":s[1]||(s[1]=p=>B.value=p),class:C([{"input-error":i.value},"inputEl-style mb-1 h-formEl !w-full rounded-btn"]),autocomplete:"one-time-code","prefix-icon":t(Pe),placeholder:t(l)("code")},{suffix:m(()=>[w.value===0?(c(),L(a,{key:0,onClick:s[0]||(s[0]=p=>F()),type:"text",class:"px-0 !text-mainColor-900"},{default:m(()=>[z(n(t(l)("resend")),1)]),_:1})):(c(),y("span",Ne,n(t(l)("resend"))+" "+n(w.value)+"s ",1))]),_:1},8,["modelValue","class","prefix-icon","placeholder"]),i.value?(c(),y("div",je,n(i.value),1)):$("",!0),o("span",ze,n(t(l)("codeToEmail")),1),i.value?$("",!0):(c(),y("div",Oe)),_(d,{ref_key:"passwordInput",ref:q,modelValue:v.value,"onUpdate:modelValue":s[2]||(s[2]=p=>v.value=p),onInput:ne,class:C([{"input-error":f.value},"inputEl-style mb-1 h-formEl !w-full rounded-btn"]),autocomplete:"off","prefix-icon":t(K),type:x.value?"text":"password",maxlength:"20",placeholder:t(l)("enterPassword")},{suffix:m(()=>[_(g,{onClick:re,class:"cursor-pointer"},{default:m(()=>[(c(),L(Q(x.value?t(Y):t(J))))]),_:1})]),_:1},8,["modelValue","class","prefix-icon","type","placeholder"]),f.value?(c(),y("div",We,n(f.value),1)):$("",!0),o("div",Ze,[o("span",qe,n(t(l)("passwordLeval"))+"： ",1),o("div",Ge,[o("div",He,[o("div",{class:C(["password-leve-line",[N.value>=1?"!bg-subColor-normal":""]])},null,2),o("div",Qe,n(t(l)("Weak")),1)]),o("div",Ye,[o("div",{class:C(["password-leve-line",[N.value>=2?"medium-bg":""]])},null,2),o("div",Je,n(t(l)("Medium")),1)]),o("div",Ke,[o("div",{class:C(["password-leve-line",[N.value>=3?"!bg-thirdColor":""]])},null,2),o("div",Xe,n(t(l)("Strong")),1)])])]),f.value?$("",!0):(c(),y("div",et)),_(d,{ref_key:"confirmPwdInput",ref:G,modelValue:S.value,"onUpdate:modelValue":s[3]||(s[3]=p=>S.value=p),onInput:ue,class:C([{"input-error":b.value},"inputEl-style h-formEl !w-full rounded-btn"]),autocomplete:"off","prefix-icon":t(K),type:h.value?"text":"password",maxlength:"20",placeholder:t(l)("confirmPassword")},{suffix:m(()=>[_(g,{onClick:ie,class:"cursor-pointer"},{default:m(()=>[(c(),L(Q(h.value?t(Y):t(J))))]),_:1})]),_:1},8,["modelValue","class","prefix-icon","type","placeholder"]),o("span",tt,n(b.value),1),_(a,{class:"mb-[2.2rem] !h-formEl w-full !rounded-btn text-[1.1rem] font-bold",type:"primary",color:"#3470FF",onClick:oe,loading:E.value,disabled:!ae.value},{default:m(()=>[z(n(t(u)==="reset"?t(l)("resetPassword"):t(l)("sign_up")),1)]),_:1},8,["loading","disabled"]),U.agreeTerm?(c(),L(T,{key:4})):$("",!0)]),_(Be,{modelValue:D.value,"onUpdate:modelValue":s[4]||(s[4]=p=>D.value=p),onConfirm:le},null,8,["modelValue"])])}}},nt=te(st,[["__scopeId","data-v-ff2ace59"]]);export{nt as _};
