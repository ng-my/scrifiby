import{J as h,n as m,K as L,L as $,a as R,M as i,y as T,q as U}from"./DjTJqZtn.js";const{reportSystemError:c}=L(),I=m(),S=I.public.baseUrl;function f(){{const s=i(),e=T();s.setUserInfo(""),setTimeout(()=>{U(e("/user/login"))},50)}}const p=h.create({baseURL:S,onRequest({options:s}){var u,a;let e=((a=(u=R().$i18n)==null?void 0:u.locale)==null?void 0:a.value)||"en-US";const n=-new Date().getTimezoneOffset()/60,g=`UTC${n>=0?"+":""}${n}:00`,t=i();let r="";t.userInfo&&typeof t.userInfo=="object"&&"token"in t.userInfo&&(r=t.userInfo.token);const o=new Headers(s.headers);o.get("X-Language")||o.set("X-Language",`${e}`),o.set("X-Time-Zone",`${g}`);const l=o.get("Authorization");r&&!l&&o.set("Authorization",`Bearer ${r}`),s.headers=o},onResponse({response:s}){let e=s._data||{};return e!=null&&e.code&&c(s,!1),s._data},onResponseError({response:s}){let e=s._data||{};if([401].includes(e==null?void 0:e.code)){f();return}return c(s,!1),$.error((e==null?void 0:e.message)||(e==null?void 0:e.code)||`${e==null?void 0:e.error}【${e==null?void 0:e.status}】`),f(),Promise.reject(s._data)}});export{p as r};
